(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    555430,      15066]
NotebookOptionsPosition[    553725,      15003]
NotebookOutlinePosition[    554113,      15020]
CellTagsIndexPosition[    554070,      15017]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<RiemannHilbert`RandomMatrices`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<RiemannHilbert`\>\"", ",", "\"\<RiemannHilbert`Common`\>\""}], 
     "}"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Documentation", "Section"],

Cell[BoxData[{
 RowBox[{"OrthogonalPolynomialGenerator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"OrthogonalPolynomialMatrixGeneratorConnected", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OrthogonalPolynomialMatrixGeneratorConnectedAdaptive", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OrthogonalPolynomialMatrixGeneratorForRoots", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OrthogonalPolynomialMatrixGenerator", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvariantEnsembleKernel", ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvariantEnsembleKernelAdaptive", ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvariantEnsembleKernelAdaptiveNew", ";"}], "\[IndentingNewLine]", 
 RowBox[{"HOInvariantEnsembleKernel", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GFunction", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftOfLine", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightOfLine", ";"}], "\[IndentingNewLine]", 
 RowBox[{"EMInvariantEnsembleKernel", ";"}], "\[IndentingNewLine]", 
 RowBox[{"TracyWidomEdgeScalingConstant", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.53454050485336*^9, 3.5345405107385798`*^9}, {
  3.554073055007407*^9, 3.55407305602337*^9}, {3.5540733327182913`*^9, 
  3.554073333328246*^9}, {3.5540785789114113`*^9, 3.5540785812944193`*^9}, {
  3.5540799801425543`*^9, 3.55407998038303*^9}, {3.5540804857607822`*^9, 
  3.55408048681546*^9}, {3.554488010952302*^9, 3.554488015045302*^9}, {
  3.5699560012541018`*^9, 3.569956012491881*^9}, {3.5774868950202427`*^9, 
  3.577486895714129*^9}, {3.577564707029127*^9, 3.577564719717457*^9}, {
  3.5775662794063168`*^9, 3.5775662801086893`*^9}, {3.592310318527017*^9, 
  3.5923103206525793`*^9}, {3.592332312387432*^9, 3.592332314493203*^9}, {
  3.5923993501835423`*^9, 3.592399351744811*^9}, {3.592477065651392*^9, 
  3.592477069841689*^9}, {3.5929136922640963`*^9, 3.592913704136526*^9}, {
  3.598473455923007*^9, 3.598473458865382*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Routines", "Section",
 CellChangeTimes->{{3.5345404876667767`*^9, 3.53454048851369*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GFunction", "[", 
      RowBox[{"V_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "supp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"supp", "=", 
         RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CauchyInverseIntegral", "[", 
         RowBox[{
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{"V", "'"}], ",", 
            RowBox[{"Line", "[", "supp", "]"}]}], "]"}], ",", "z"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GFunction", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", "V_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "supp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"supp", "=", 
         RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CauchyInverseIntegralS", "[", 
         RowBox[{"s", ",", 
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{"V", "'"}], ",", 
            RowBox[{"Line", "[", "supp", "]"}]}], "]"}], ",", "z"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftOfLine", "[", 
      RowBox[{"z_", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Im", "[", "a", "]"}], "-", 
          RowBox[{"Im", "[", "b", "]"}]}], 
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], "-", 
          RowBox[{"Re", "[", "b", "]"}]}]], 
        RowBox[{"Re", "[", "z", "]"}]}], " ", "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "b", "]"}], " ", 
          RowBox[{"Re", "[", "a", "]"}]}], " ", "-", 
         RowBox[{
          RowBox[{"Im", "[", "a", "]"}], " ", 
          RowBox[{"Re", "[", "b", "]"}]}]}], 
        RowBox[{
         RowBox[{"Re", "[", "a", "]"}], "-", 
         RowBox[{"Re", "[", "b", "]"}]}]]}], "<", 
      RowBox[{"Im", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightOfLine", "[", 
      RowBox[{"z_", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Im", "[", "a", "]"}], "-", 
          RowBox[{"Im", "[", "b", "]"}]}], 
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], "-", 
          RowBox[{"Re", "[", "b", "]"}]}]], 
        RowBox[{"Re", "[", "z", "]"}]}], " ", "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "b", "]"}], " ", 
          RowBox[{"Re", "[", "a", "]"}]}], " ", "-", 
         RowBox[{
          RowBox[{"Im", "[", "a", "]"}], " ", 
          RowBox[{"Re", "[", "b", "]"}]}]}], 
        RowBox[{
         RowBox[{"Re", "[", "a", "]"}], "-", 
         RowBox[{"Re", "[", "b", "]"}]}]]}], ">", 
      RowBox[{"Im", "[", "z", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.509355658099462*^9, 3.509355738862837*^9}, 
   3.509355791608021*^9, {3.50935693881168*^9, 3.509356944908375*^9}, 
   3.509357023884433*^9, {3.51065667811443*^9, 3.510656678420891*^9}, {
   3.5345405161098413`*^9, 3.534540522592524*^9}, 3.554079978051839*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrthogonalPolynomialMatrixGenerator", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"M_:", "40"}], ",", 
     RowBox[{"L_:", "5."}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "g", ",", "l", ",", "z", ",", "\[Phi]", ",", "supp", ",", "P", ",", 
       "Pin", ",", "rngg", ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", 
       "B", ",", "AP", ",", "BP", ",", "gs", ",", "m", ",", "U", ",", 
       "\[CapitalPsi]", ",", "\[CapitalPhi]", ",", "p", ",", "slvr", ",", "Y",
        ",", "UD", ",", "\[CapitalPsi]D", ",", "\[Phi]D", ",", 
       "\[CapitalPhi]D", ",", "YD", ",", "PD", ",", "BD", ",", "BinD"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"supp", "=", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=", 
         RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", "z_", "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{"V", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
          RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
        RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
        RowBox[{
         RowBox[{"g", "'"}], "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", "z_", "]"}], "=", 
       RowBox[{"Parametrix", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PD", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"ParametrixBranch", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z", ",", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", "z_", "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rngg", "=", 
       RowBox[{"{", 
        RowBox[{".5", ",", "L"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Cdefs", "[", "m_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"n", ",", 
           RowBox[{"(", GridBox[{
              {"b", "a"},
              {
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]], 
               RowBox[{"-", 
                SuperscriptBox["n", 
                 RowBox[{"2", "/", "3"}]]}]}
             }], ")"}]}], "]"}], ",", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Line", "[", "rngg", "]"}], "m"},
            {
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "\[Pi]", " ", 
                 RowBox[{"I", "/", "3"}]}], "]"}], 
               RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
            {
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
               RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
            {
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"2", " ", "I", " ", 
                   RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ",
                 "}"}], 
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}], "m"},
            {
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", " ", ",", 
                 RowBox[{"Exp", "[", " ", 
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "I", " ", 
                   RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}], "m"},
            {
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Exp", "[", " ", 
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "I", " ", 
                   RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", 
                 RowBox[{"Exp", "[", " ", 
                  RowBox[{
                   RowBox[{"-", "4"}], " ", "I", " ", 
                   RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}], "m"}
           }], ")"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], " ", "n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]},
          {"0", "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gs", "[", "n_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"AP", "[", "n", "]"}], 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{
              RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
          {
           RowBox[{"BP", "[", "n", "]"}], 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{
              RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
          {
           RowBox[{"BP", "[", "n", "]"}], 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{
              RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", GridBox[{
                {
                 RowBox[{"Exp", "[", 
                  RowBox[{"n", " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                {"0", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
               }], ")"}], ".", 
             RowBox[{"Pin", "[", "#", "]"}]}], "&"}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", GridBox[{
                {"1", 
                 RowBox[{"-", "1"}]},
                {"1", "0"}
               }], ")"}], ".", 
             RowBox[{"(", GridBox[{
                {
                 RowBox[{"Exp", "[", 
                  RowBox[{"n", " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                {"0", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
               }], ")"}], ".", 
             RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", GridBox[{
                {"1", 
                 RowBox[{"-", "1"}]},
                {"0", "1"}
               }], ")"}], ".", 
             RowBox[{"(", GridBox[{
                {
                 RowBox[{"Exp", "[", 
                  RowBox[{"n", " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                {"0", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
               }], ")"}], ".", 
             RowBox[{"Pin", "[", "#", "]"}]}], "&"}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", GridBox[{
                {"1", "0"},
                {"1", "1"}
               }], ")"}], ".", 
             RowBox[{"(", GridBox[{
                {
                 RowBox[{"Exp", "[", 
                  RowBox[{"n", " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                {"0", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
               }], ")"}], ".", 
             RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", GridBox[{
                {"0", 
                 RowBox[{"-", "1"}]},
                {"1", "1"}
               }], ")"}], ".", 
             RowBox[{"(", GridBox[{
                {
                 RowBox[{"Exp", "[", 
                  RowBox[{"n", " ", 
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
                {"0", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
               }], ")"}], ".", 
             RowBox[{"Pin", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", GridBox[{
                {"0", 
                 RowBox[{"-", "1"}]},
                {"1", "0"}
               }], ")"}], ".", 
             RowBox[{"(", GridBox[{
                {
                 RowBox[{"Exp", "[", 
                  RowBox[{"n", " ", 
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
                {"0", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
               }], ")"}], ".", 
             RowBox[{"Pin", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}
         }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"slvr", "=", 
       RowBox[{"ScaledRHSolver", "[", 
        RowBox[{"Cdefs", "[", "M", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", "n", "]"}], "=", 
        RowBox[{"slvr", "[", 
         RowBox[{"n", ",", 
          RowBox[{"gs", "[", "n", "]"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"Dot", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
            RowBox[{"Cauchy", "[", 
             RowBox[{"#", ",", "z"}], "]"}]}], "&"}], "/@", 
          RowBox[{"U", "[", "n", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
              "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"2", " ", 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], "&&", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{"-", "1"}], "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"0", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
              "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
           RowBox[{"Cauchy", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", "z"}], "]"}]}], ")"}], ".", 
         RowBox[{"CauchyD", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "z"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"CauchyD", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "z"}], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
           RowBox[{"Cauchy", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "z"}], "]"}]}], ")"}]}]}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
              "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"2", " ", 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {
              RowBox[{"-", "1"}], "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"0", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {"1", "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
              "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"P", "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"YD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"YD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"\[CapitalPhi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{
           RowBox[{"g", "'"}], "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"\[CapitalPhi]", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Y", ",", "YD"}], "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrthogonalPolynomialGenerator", "[", 
   RowBox[{"V_", ",", 
    RowBox[{"M_:", "40"}], ",", 
    RowBox[{"L_:", "5."}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Y", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Y", "=", 
      RowBox[{
       RowBox[{"OrthogonalPolynomialMatrixGenerator", "[", 
        RowBox[{"V", ",", "M", ",", "L"}], "]"}], "\[LeftDoubleBracket]", "1",
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n", ",", "z"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "p"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ3fXJfsl01VeO0ZVuB0G0gPPKn3fUXzk+kz8PpmMy
S8TvAum9K45KgOglx9hUQfSa5zMMwfROfSsQreFqag2iO6vM2B4B6TPXJNlB
tNHDwm4QnfDYsgdEr/u6N4BL45XjApVl8SBaoOxuKTeQXnT7F5heZhRSC6Ir
J6aCaQ09/Tsget6ry/dBtPIGpycgWuXPv6cg2r7g8ksQfWePIxcPkI57elwQ
RD/Z5ysCoo+pp8uB6CqdQjUQfSBc2whEr9mrbAqil53XsQbR35/32IBoi06f
IhCtkdJQBqJdZhe+nhn6ytGyu/ALiDZa8PMniE6x0vwFosPknzbcq3rlOGmR
eDOI1jllOwFEL/j9ZRKItnJcegREazWqHQPRAF7wsNo=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Connected", "Section",
 CellChangeTimes->{{3.5193709710781612`*^9, 3.51937097231778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrthogonalPolynomialMatrixGeneratorConnected", "[", 
   RowBox[{"V_", ",", 
    RowBox[{"M_:", "40"}], ",", 
    RowBox[{"L_:", "3."}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "supp", ",", "g", ",", "l", ",", "z", ",", "\[Phi]", ",", "P", ",", 
      "Pin", ",", "rngg", ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", 
      "B", ",", "AP", ",", "BP", ",", "gs", ",", "m", ",", "U", ",", 
      "\[CapitalPsi]", ",", "\[CapitalPhi]", ",", "p", ",", "slvr", ",", "Y", 
      ",", "UD", ",", "\[CapitalPsi]D", ",", "\[Phi]D", ",", "\[CapitalPhi]D",
       ",", "YD", ",", "PD", ",", "BD", ",", "BinD"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"supp", "=", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "=", 
        RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", "z_", "]"}], "=", 
      RowBox[{"GFunction", "[", 
       RowBox[{"V", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
      RowBox[{"GFunction", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
      RowBox[{"GFunction", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l", "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
         RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
       RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
       RowBox[{
        RowBox[{"g", "'"}], "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "[", "z_", "]"}], "=", 
      RowBox[{"Parametrix", "[", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0", "1"},
           {
            RowBox[{"-", "1"}], "0"}
          }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PD", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
      RowBox[{"ParametrixBranch", "[", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0", "1"},
           {
            RowBox[{"-", "1"}], "0"}
          }], ")"}], ",", "supp", ",", "z", ",", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pin", "[", "z_", "]"}], "=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pin", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rngg", "=", 
      RowBox[{"{", 
       RowBox[{".5", ",", "L"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cdefs", "[", "m_", "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"n", ",", 
          RowBox[{"(", GridBox[{
             {"b", "a"},
             {
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]], 
              RowBox[{"-", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}
            }], ")"}]}], "]"}], ",", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Line", "[", "rngg", "]"}], "m"},
           {
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "\[Pi]", " ", 
                RowBox[{"I", "/", "3"}]}], "]"}], 
              RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
           {
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
              RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
           {
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
               "}"}], 
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "m"},
           {
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", " ", ",", 
                RowBox[{"Exp", "[", " ", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "m"},
           {
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Exp", "[", " ", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", 
                RowBox[{"Exp", "[", " ", 
                 RowBox[{
                  RowBox[{"-", "4"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "m"}
          }], ")"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {"1", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", 
            RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]},
         {"0", "1"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {
          RowBox[{"Exp", "[", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "1"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{
       RowBox[{"P", "[", "z", "]"}], ".", 
       RowBox[{
        RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
       RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{
       RowBox[{"P", "[", "z", "]"}], ".", 
       RowBox[{
        RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
       RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {"0", "0"},
         {
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"\[Phi]D", "[", "z", "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {"0", "0"},
         {
          RowBox[{
           RowBox[{"-", "2"}], " ", "n", " ", 
           RowBox[{"\[Phi]D", "[", "z", "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
        }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gs", "[", "n_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"AP", "[", "n", "]"}], 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
         {
          RowBox[{"BP", "[", "n", "]"}], 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
         {
          RowBox[{"BP", "[", "n", "]"}], 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"1", 
                RowBox[{"-", "1"}]},
               {"1", "0"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"1", 
                RowBox[{"-", "1"}]},
               {"0", "1"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"1", "0"},
               {"1", "1"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"0", 
                RowBox[{"-", "1"}]},
               {"1", "1"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"0", 
                RowBox[{"-", "1"}]},
               {"1", "0"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}
        }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"U", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{"U", "[", "n", "]"}], "=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"ConstructCurve", "[", 
           RowBox[{
            RowBox[{"Cdefs", "[", "M", "]"}], ",", 
            RowBox[{"gs", "[", "n", "]"}], ",", "n"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{"BP", "[", "n", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"a", "+", 
                  RowBox[{
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{"\[Pi]", " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                   RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}], ",", 
                 RowBox[{"b", "+", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"2", " ", "\[Pi]", " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                   RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}]}], "}"}], "]"}], ",", 
              RowBox[{"M", "+", "20"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{"BP", "[", "n", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"a", "+", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", " ", "\[Pi]"}], " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                   RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}], ",", 
                 RowBox[{"b", "+", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                   RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}]}], "}"}], "]"}], ",", 
              RowBox[{"M", "+", "20"}]}], "]"}]}], "\[IndentingNewLine]", 
           "}"}]}], "]"}], "//", "RHSolve"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"U", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
        RowBox[{"Cauchy", "[", 
         RowBox[{
          RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"RightOfLine", "[", 
         RowBox[{
          RowBox[{"z", "-", "b"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
             "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", 
         RowBox[{"2", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], ">", 
         RowBox[{"b", "+", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], "&&", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {
           RowBox[{"-", "1"}], "1"}
         }], ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], ">", 
         RowBox[{"b", "+", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {"0", 
           RowBox[{"-", "1"}]},
          {"1", "1"}
         }], ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"RightOfLine", "[", 
         RowBox[{
          RowBox[{"z", "-", "b"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Pi]", "/", "3"}]}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{"-", "1"}]},
          {"0", "1"}
         }], ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], "<", 
         RowBox[{"a", "-", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
         RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"LeftOfLine", "[", 
         RowBox[{
          RowBox[{"a", "-", "z"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"\[Pi]", "/", "3"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {"1", "1"}
         }], ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"LeftOfLine", "[", 
         RowBox[{
          RowBox[{"a", "-", "z"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
             "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{"-", "1"}]},
          {"1", "0"}
         }], ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], "<", 
         RowBox[{"a", "-", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"(", GridBox[{
          {"0", 
           RowBox[{"-", "1"}]},
          {"1", "0"}
         }], ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"Exp", "[", 
            RowBox[{"n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
          {"0", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "n"}], " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "3"}]}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", 
         RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{
        RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
        RowBox[{
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n", ",", "z"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", "    ", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n", ",", "z"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"l", "/", "2"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"l", "/", "2"}]}], "]"}]}
          }], ")"}], ".", 
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"l", "/", "2"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"l", "/", "2"}]}], "]"}]}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"g", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UD", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"CauchyD", "[", 
       RowBox[{
        RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"RightOfLine", "[", 
         RowBox[{
          RowBox[{"z", "-", "b"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
             "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", 
         RowBox[{"2", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], ">", 
         RowBox[{"b", "+", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{"-", "1"}], "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], ">", 
         RowBox[{"b", "+", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "1"}
          }], ")"}], " ", ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"RightOfLine", "[", 
         RowBox[{
          RowBox[{"z", "-", "b"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Pi]", "/", "3"}]}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"0", "1"}
          }], ")"}], " ", ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], "<", 
         RowBox[{"a", "-", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
         RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"LeftOfLine", "[", 
         RowBox[{
          RowBox[{"a", "-", "z"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"\[Pi]", "/", "3"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"LeftOfLine", "[", 
         RowBox[{
          RowBox[{"a", "-", "z"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
             "}"}], 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "z", "]"}], "<", 
         RowBox[{"a", "-", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
            "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            " ", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
             SuperscriptBox["n", 
              RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"n", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
            {"0", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
           }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPsi]D", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"P", "[", "z", "]"}]}], "+", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "3"}]}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", 
         RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{
         RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
        RowBox[{
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "b"}], "]"}], "<", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
         RowBox[{"Arg", "[", 
          RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{
         RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalPhi]D", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"\[CapitalPsi]D", "[", 
       RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"YD", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"YD", "[", 
        RowBox[{"n", ",", "z"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{"n", " ", 
         RowBox[{
          RowBox[{"g", "'"}], "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Y", ",", "YD"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.509370145998357*^9, 3.509370378202314*^9}, {
   3.5105607172894363`*^9, 3.510560718472644*^9}, {3.5105609556378613`*^9, 
   3.510560966176848*^9}, {3.510561064211748*^9, 3.5105611647782803`*^9}, {
   3.510561233491415*^9, 3.510561241664692*^9}, {3.510571057702458*^9, 
   3.5105710648074703`*^9}, {3.5105721235587397`*^9, 
   3.5105721298090057`*^9}, {3.51065357393624*^9, 3.510653693191971*^9}, {
   3.510655918920662*^9, 3.5106559198393106`*^9}, {3.5106559786311827`*^9, 
   3.510655979174008*^9}, {3.5106567374743843`*^9, 3.51065676662239*^9}, {
   3.510656802084001*^9, 3.510656815968279*^9}, {3.510656846607452*^9, 
   3.510657106054304*^9}, {3.510657166246749*^9, 3.510657186429552*^9}, {
   3.510657267223605*^9, 3.5106573315366793`*^9}, {3.5106574253544617`*^9, 
   3.5106574491169033`*^9}, {3.5106574974003477`*^9, 3.510657508403316*^9}, {
   3.5106579383917503`*^9, 3.510657972012226*^9}, {3.5193718159736443`*^9, 
   3.519371867285171*^9}, {3.519371903930711*^9, 3.519371905121751*^9}, {
   3.554078604495112*^9, 3.5540786050620413`*^9}, 3.554079969825622*^9, {
   3.554081608784966*^9, 3.55408161211854*^9}, {3.554081650065937*^9, 
   3.5540816507992067`*^9}, {3.554081770758059*^9, 3.5540817710766*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Connected and adaptive", "Section",
 CellChangeTimes->{{3.5193709710781612`*^9, 3.51937097231778*^9}, {
  3.5764691062511787`*^9, 3.576469112751552*^9}, {3.577466684952466*^9, 
  3.5774666871812267`*^9}, {3.57756445800208*^9, 3.577564458142564*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeListFun", "[", 
    RowBox[{"{", 
     RowBox[{"Jumps_", ",", "Domains_", ",", "NumPts_"}], "}"}], "]"}], ":=", 
   
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Fun", "[", 
       RowBox[{
        RowBox[{"Jumps", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Domains", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"NumPts", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "Jumps", "]"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cc", "[", "z_", "]"}], ":=", 
   RowBox[{"Conjugate", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SignChange", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sign", "[", "x", "]"}], "*", 
       RowBox[{"Sign", "[", "y", "]"}]}], "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", "True", ",", "False"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TruncateMatrix", "[", 
     RowBox[{"tol_", ",", "step_"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"F_", ",", "Domain_", ",", "n_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "x_", "]"}], ":=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"F", "[", "x", "]"}], "-", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Truncate", "[", 
        RowBox[{"tol", ",", "step"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "Domain", ",", "n"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Truncate", "[", 
     RowBox[{"tol_", ",", "step_"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"F_", ",", "Domain_", ",", "n_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f1", ",", "vals", ",", "x", ",", "dx", ",", "i", ",", "Change"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", " ", "=", " ", 
       RowBox[{"step", "/", 
        RowBox[{"Abs", "[", 
         RowBox[{"MapFromIntervalD", "[", 
          RowBox[{"Domain", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", " ", "=", " ", 
       RowBox[{"Fun", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", "Domain", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"F", "[", 
              RowBox[{"MapFromInterval", "[", 
               RowBox[{"f1", ",", "x"}], "]"}], "]"}], "]"}], "-", "tol"}], 
           ",", 
           RowBox[{"MapFromInterval", "[", 
            RowBox[{"f1", ",", "x"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "1"}], ",", "1", ",", "dx"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Change", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"F", "[", 
            RowBox[{"MapFromInterval", "[", 
             RowBox[{"f1", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "-", "tol"}], ">", 
         "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Change", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MapFromInterval", "[", 
              RowBox[{"f1", ",", 
               RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "}"}], "}"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Initialization: \>\"", ",", "Change", ",", 
          "\"\<  first value:  \>\"", ",", " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"F", "[", 
             RowBox[{"MapFromInterval", "[", 
              RowBox[{"f1", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "-", "tol"}]}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Guaranteed", " ", "to", " ", "work", " ", "only", " ", "for", " ", 
        "evelope", " ", 
        RowBox[{"(", "positive", ")"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{
          RowBox[{"Length", "[", "vals", "]"}], "-", "3"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SignChange", "[", 
            RowBox[{
             RowBox[{"vals", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"vals", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"Change", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"Change", ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vals", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"vals", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
                    ")"}], "/", "2"}], ",", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"vals", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                   "]"}]}], "}"}], "}"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Change", " ", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"Change", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Change", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"Change", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MapFromInterval", "[", 
                RowBox[{"f1", ",", "1"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"Domain", ",", 
           RowBox[{"Change", "//", "CreateDomains"}]}], "}"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Domain", "//", "DomainPlot"}], ",", 
           RowBox[{"Fun", "[", 
            RowBox[{
             RowBox[{"vals", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "Domain"}], 
            "]"}], ",", 
           RowBox[{"Change", "//", "CreateDomains"}]}], "}"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Change", "//", "CreateDomains"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDomains", "[", "V_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "V", "]"}]}], ",", 
        RowBox[{"i", "=", "i"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"out", " ", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"out", ",", 
               RowBox[{"{", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], 
                  "}"}], "]"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"i", " ", "=", " ", 
             RowBox[{"i", "+", "2"}]}], ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", " ", "=", " ", 
             RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "out"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Adapt", "[", 
     RowBox[{"f_", ",", "tol_", ",", "step_"}], "]"}], "[", "F_", "]"}], ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", "save", ",", "i", ",", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "i"}], "]"}], "]"}], "//", 
          RowBox[{"TruncateMatrix", "[", 
           RowBox[{"tol", ",", "step"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"f", "//", "Transpose"}], "//", "Length"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"save", "=", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "out", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", 
             RowBox[{"out", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"save", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"save", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"F", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"out", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"F", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "i"}], "]"}], "]"}]}], "}"}], "}"}], "//",
                "Transpose"}], ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "save"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineConjugate", "[", "L_List", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "//", "Conjugate"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineReverse", "[", "L_List", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "//", "Reverse"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.509370145998357*^9, 3.509370378202314*^9}, {
   3.5105607172894363`*^9, 3.510560718472644*^9}, {3.5105609556378613`*^9, 
   3.510560966176848*^9}, {3.510561064211748*^9, 3.5105611647782803`*^9}, {
   3.510561233491415*^9, 3.510561241664692*^9}, {3.510571057702458*^9, 
   3.5105710648074703`*^9}, {3.5105721235587397`*^9, 
   3.5105721298090057`*^9}, {3.51065357393624*^9, 3.510653693191971*^9}, {
   3.510655918920662*^9, 3.5106559198393106`*^9}, {3.5106559786311827`*^9, 
   3.510655979174008*^9}, {3.5106567374743843`*^9, 3.51065676662239*^9}, {
   3.510656802084001*^9, 3.510656815968279*^9}, {3.510656846607452*^9, 
   3.510657106054304*^9}, {3.510657166246749*^9, 3.510657186429552*^9}, {
   3.510657267223605*^9, 3.5106573315366793`*^9}, {3.5106574253544617`*^9, 
   3.5106574491169033`*^9}, {3.5106574974003477`*^9, 3.510657508403316*^9}, {
   3.5106579383917503`*^9, 3.510657972012226*^9}, {3.5193718159736443`*^9, 
   3.519371867285171*^9}, {3.519371903930711*^9, 3.519371905121751*^9}, {
   3.554078604495112*^9, 3.5540786050620413`*^9}, 3.554079969825622*^9, {
   3.554081608784966*^9, 3.55408161211854*^9}, {3.554081650065937*^9, 
   3.5540816507992067`*^9}, {3.554081770758059*^9, 3.5540817710766*^9}, {
   3.576469119744018*^9, 3.576469123848342*^9}, {3.576647893779862*^9, 
   3.576647915816025*^9}, {3.576647976206469*^9, 3.576648044007929*^9}, {
   3.5766481053874807`*^9, 3.5766481133708963`*^9}, {3.576648182020049*^9, 
   3.5766481899904957`*^9}, {3.576648296251515*^9, 3.5766483573912687`*^9}, {
   3.57673247499046*^9, 3.576732533261546*^9}, {3.576732626107067*^9, 
   3.5767326634136343`*^9}, {3.576732907826399*^9, 3.57673291264109*^9}, {
   3.57673295359937*^9, 3.576732959610313*^9}, {3.57673299794949*^9, 
   3.576733014079439*^9}, {3.576733518282748*^9, 3.576733518670849*^9}, {
   3.5767337065419617`*^9, 3.5767337126042547`*^9}, {3.5767958190528603`*^9, 
   3.576795827720676*^9}, {3.5767979163219967`*^9, 3.576797919678335*^9}, {
   3.576798091701907*^9, 3.5767980921801167`*^9}, {3.5768095995514297`*^9, 
   3.576809601184196*^9}, {3.5768114700664177`*^9, 3.576811471854981*^9}, {
   3.576813052547248*^9, 3.576813096474238*^9}, 3.576976982484219*^9, {
   3.576977085662451*^9, 3.576977171345381*^9}, {3.57697724853286*^9, 
   3.5769773489343443`*^9}, {3.576977415917466*^9, 3.57697742462405*^9}, {
   3.577179571150564*^9, 3.577179586240938*^9}, {3.577216296633483*^9, 
   3.577216327773486*^9}, {3.577216437899763*^9, 3.577216457705456*^9}, {
   3.577216634716185*^9, 3.577216654279069*^9}, {3.577216877308578*^9, 
   3.577216901296715*^9}, {3.5772170450201473`*^9, 3.577217088551457*^9}, {
   3.57721724649752*^9, 3.57721725607714*^9}, {3.577217496392047*^9, 
   3.577217496819829*^9}, {3.57721776134105*^9, 3.577217765997395*^9}, {
   3.5772177969339237`*^9, 3.57721779712646*^9}, {3.577217948911235*^9, 
   3.577217949181261*^9}, {3.577218160138955*^9, 3.577218162127255*^9}, {
   3.577218313900791*^9, 3.5772183394241247`*^9}, {3.577218385789227*^9, 
   3.5772183874463577`*^9}, {3.57733645927839*^9, 3.577336470858323*^9}, {
   3.577336622385036*^9, 3.577336622588818*^9}, {3.5773367498910522`*^9, 
   3.577336750157001*^9}, {3.577336781417136*^9, 3.577336817390901*^9}, {
   3.577336905089444*^9, 3.577336937319158*^9}, {3.5773370869129057`*^9, 
   3.577337087211688*^9}, {3.577337190284177*^9, 3.57733725270437*^9}, 
   3.577337338405982*^9, {3.5773374784538383`*^9, 3.5773375158356533`*^9}, {
   3.577337940057927*^9, 3.577338120756263*^9}, {3.5773382437956743`*^9, 
   3.5773382442374697`*^9}, {3.577338472725114*^9, 3.577338508321392*^9}, {
   3.577338846785322*^9, 3.577338848442369*^9}, {3.577338919601112*^9, 
   3.577338969989543*^9}, {3.577339024552103*^9, 3.577339036667684*^9}, {
   3.57733926339671*^9, 3.5773392903792887`*^9}, {3.577340232068678*^9, 
   3.577340232313665*^9}, {3.57734047045954*^9, 3.5773404707744017`*^9}, {
   3.5773405523735743`*^9, 3.577340554715529*^9}, {3.577448368370243*^9, 
   3.577448369814081*^9}, {3.577448409078994*^9, 3.577448411570938*^9}, {
   3.5774484462850523`*^9, 3.577448473353547*^9}, {3.577448646856574*^9, 
   3.577448655920291*^9}, {3.577448698728703*^9, 3.577448700156486*^9}, {
   3.577448953185169*^9, 3.577448953335719*^9}, {3.577449029598344*^9, 
   3.577449031151743*^9}, {3.577449256898121*^9, 3.577449264095483*^9}, 
   3.577449411850659*^9, {3.577449696818975*^9, 3.577449705727214*^9}, {
   3.577449874863513*^9, 3.577449878348929*^9}, {3.577449942373335*^9, 
   3.577449972052424*^9}, {3.577450137630875*^9, 3.577450140026268*^9}, {
   3.577450215694175*^9, 3.577450219883086*^9}, {3.577450266596023*^9, 
   3.57745039003188*^9}, {3.5774505292239733`*^9, 3.577450574346583*^9}, {
   3.577450644084391*^9, 3.577450666769589*^9}, {3.5774507857946167`*^9, 
   3.577450803425746*^9}, {3.577450855987179*^9, 3.577450861296125*^9}, {
   3.577450902630694*^9, 3.5774509043526583`*^9}, {3.577450935180602*^9, 
   3.5774509609488363`*^9}, {3.577451484546554*^9, 3.577451512314411*^9}, {
   3.577451634210004*^9, 3.5774516431417837`*^9}, {3.5774517246711597`*^9, 
   3.577451759124737*^9}, {3.577452217014558*^9, 3.577452235634491*^9}, {
   3.577466694630275*^9, 3.5774666970021267`*^9}, {3.577467492890172*^9, 
   3.5774674945306*^9}, 3.5774675397783327`*^9, {3.577467639806533*^9, 
   3.577467646206933*^9}, {3.577469014196224*^9, 3.5774690275360527`*^9}, {
   3.57746906529081*^9, 3.577469211507063*^9}, {3.577469263781535*^9, 
   3.5774692784088078`*^9}, {3.577469322922007*^9, 3.57746934926549*^9}, 
   3.577469450608616*^9, {3.5774695517310677`*^9, 3.577469575354165*^9}, {
   3.577469729782604*^9, 3.577469764669261*^9}, {3.577469846741064*^9, 
   3.577469941869357*^9}, {3.5774699839331293`*^9, 3.57747001273357*^9}, {
   3.5774700710296288`*^9, 3.577470071498221*^9}, {3.577470231497826*^9, 
   3.577470542464531*^9}, {3.577470579586192*^9, 3.577470581909358*^9}, {
   3.577470616245018*^9, 3.577470622290991*^9}, {3.5774706905074987`*^9, 
   3.577470712065455*^9}, {3.577470753482461*^9, 3.577470762512225*^9}, {
   3.57747080765912*^9, 3.5774708453051767`*^9}, {3.577470883410591*^9, 
   3.577470909518901*^9}, {3.577470960299328*^9, 3.57747097812964*^9}, {
   3.5774710135309763`*^9, 3.577471054819471*^9}, {3.577471105131185*^9, 
   3.57747121674889*^9}, {3.5774712736692142`*^9, 3.5774712813493032`*^9}, {
   3.577471332770768*^9, 3.5774713600279408`*^9}, {3.5774714099568987`*^9, 
   3.577471413273814*^9}, {3.577471480430286*^9, 3.57747148871177*^9}, {
   3.577471576054405*^9, 3.577471589230728*^9}, {3.577471639648807*^9, 
   3.5774717277724457`*^9}, {3.577471757859212*^9, 3.57747175919149*^9}, {
   3.5774718360928097`*^9, 3.577471876348534*^9}, {3.57747192072331*^9, 
   3.577472004236505*^9}, {3.577472118549767*^9, 3.577472144482641*^9}, {
   3.5774721821961308`*^9, 3.577472187590149*^9}, {3.5774722324767113`*^9, 
   3.5774722357464542`*^9}, {3.577472276130987*^9, 3.577472287253936*^9}, {
   3.577472353827825*^9, 3.5774723748267593`*^9}, {3.577472427843499*^9, 
   3.577472482844208*^9}, {3.5774725983915787`*^9, 3.577472605291254*^9}, {
   3.57747269209671*^9, 3.577472709933167*^9}, {3.577472756425712*^9, 
   3.577473018335843*^9}, {3.577473122079623*^9, 3.577473201501502*^9}, {
   3.577473241836405*^9, 3.577473385025901*^9}, {3.57747345749713*^9, 
   3.5774734617735367`*^9}, {3.57747349465724*^9, 3.577473495657447*^9}, {
   3.577473544764789*^9, 3.5774735451431313`*^9}, {3.5774735919351187`*^9, 
   3.5774735925342903`*^9}, {3.577473626015759*^9, 3.577473629294495*^9}, {
   3.577473709877225*^9, 3.577473771742038*^9}, {3.5774738223515863`*^9, 
   3.577473822747569*^9}, 3.577473871093164*^9, {3.5774739092574053`*^9, 
   3.577473987461687*^9}, {3.5774740856113377`*^9, 3.5774740857806587`*^9}, {
   3.5774741727098923`*^9, 3.577474180444517*^9}, {3.577474270180341*^9, 
   3.577474270375058*^9}, {3.577474327218746*^9, 3.5774743660076427`*^9}, {
   3.577474473008046*^9, 3.577474475579815*^9}, {3.577474686350478*^9, 
   3.5774746865465317`*^9}, {3.577474737145671*^9, 3.5774747438448887`*^9}, {
   3.577474842612925*^9, 3.577474845871449*^9}, {3.577474965692676*^9, 
   3.5774749659139957`*^9}, {3.5774760236194353`*^9, 3.577476031692683*^9}, {
   3.577476102526338*^9, 3.5774761164394703`*^9}, 3.577476152622216*^9, {
   3.577476331606687*^9, 3.577476333304427*^9}, {3.577476427455943*^9, 
   3.577476428148288*^9}, {3.577476503263781*^9, 3.577476511137562*^9}, {
   3.577476585833584*^9, 3.5774765925595303`*^9}, {3.57747667192419*^9, 
   3.5774766729024677`*^9}, {3.577477019605842*^9, 3.5774770219076147`*^9}, {
   3.577477078546674*^9, 3.577477082811212*^9}, {3.577477315985784*^9, 
   3.577477316157278*^9}, 3.5774774615795383`*^9, {3.577477540999318*^9, 
   3.5774777496945*^9}, {3.5774777919207087`*^9, 3.5774778638361473`*^9}, {
   3.577477943414733*^9, 3.5774779445494337`*^9}, {3.5774794643025713`*^9, 
   3.577479464511054*^9}, {3.5774795477056227`*^9, 3.57747954812007*^9}, {
   3.57747966472499*^9, 3.577479687967051*^9}, {3.5774797899915447`*^9, 
   3.5774797918113747`*^9}, {3.577480687355667*^9, 3.5774806930338287`*^9}, {
   3.577480813231119*^9, 3.577480813706113*^9}, {3.577481007627221*^9, 
   3.577481032501214*^9}, {3.577481756386951*^9, 3.577481838328659*^9}, {
   3.577481910845418*^9, 3.577481914665922*^9}, {3.577482002808676*^9, 
   3.5774820477705297`*^9}, {3.577482167897505*^9, 3.57748219742029*^9}, {
   3.5774823473825073`*^9, 3.577482356104018*^9}, {3.577482699269247*^9, 
   3.577482699458552*^9}, {3.5774830200463963`*^9, 3.577483033567772*^9}, {
   3.577547825054574*^9, 3.577547839073022*^9}, {3.5775478823017187`*^9, 
   3.577547891305614*^9}, {3.57754794470258*^9, 3.577547979846801*^9}, {
   3.5775481652950497`*^9, 3.577548206556439*^9}, {3.577549259470276*^9, 
   3.577549301975171*^9}, {3.577549360405389*^9, 3.5775494028349133`*^9}, {
   3.57754947227182*^9, 3.577549506080606*^9}, {3.577549552744769*^9, 
   3.57754956876758*^9}, {3.577549637041798*^9, 3.577549663067255*^9}, {
   3.577550676499661*^9, 3.5775507139288177`*^9}, {3.577550755024453*^9, 
   3.577550781736662*^9}, {3.577550856167993*^9, 3.577550995023685*^9}, {
   3.577551427358204*^9, 3.577551434064209*^9}, {3.577551471978445*^9, 
   3.5775514773780193`*^9}, {3.5775515492579927`*^9, 3.577551553531538*^9}, 
   3.577551624234394*^9, {3.5775516600661287`*^9, 3.577551671317505*^9}, {
   3.577551701340952*^9, 3.577551704540411*^9}, {3.5775517369216633`*^9, 
   3.577551739245491*^9}, 3.577551853777719*^9, {3.5775519268063707`*^9, 
   3.5775519314114027`*^9}, {3.577552459866061*^9, 3.577552464723988*^9}, {
   3.577552704745509*^9, 3.577552710816368*^9}, {3.5775528774774714`*^9, 
   3.577552900136368*^9}, {3.577552943903893*^9, 3.577552976077619*^9}, {
   3.577553017695055*^9, 3.577553068410698*^9}, {3.577553134944248*^9, 
   3.57755314290965*^9}, {3.577553274650592*^9, 3.577553294044191*^9}, {
   3.577555307016404*^9, 3.577555323539833*^9}, {3.577556104659492*^9, 
   3.5775561054094543`*^9}, 3.577556613795887*^9, {3.577557139925427*^9, 
   3.577557144622759*^9}, {3.577557249495479*^9, 3.5775572497067757`*^9}, {
   3.577557508943968*^9, 3.577557514926602*^9}, {3.577560295384589*^9, 
   3.5775602988181553`*^9}, {3.577560337683826*^9, 3.577560338790943*^9}, {
   3.577560702321291*^9, 3.577560764783478*^9}, {3.577560970822215*^9, 
   3.577560975128771*^9}, {3.577561031997505*^9, 3.577561035561541*^9}, {
   3.577561237362239*^9, 3.577561294227586*^9}, {3.577561329166605*^9, 
   3.577561330227284*^9}, {3.577561372906612*^9, 3.577561558971698*^9}, {
   3.5775620767619667`*^9, 3.577562090474921*^9}, {3.577562201299815*^9, 
   3.577562234827519*^9}, {3.577562435351471*^9, 3.5775624668495073`*^9}, {
   3.5775625356651297`*^9, 3.577562541488331*^9}, {3.577562691213723*^9, 
   3.577562712811017*^9}, {3.5775627570933867`*^9, 3.577562821080009*^9}, {
   3.577564518497747*^9, 3.577564522699746*^9}, {3.5775647842016706`*^9, 
   3.577564784651029*^9}, {3.577564989585784*^9, 3.5775650176748*^9}, {
   3.577565114783169*^9, 3.577565118387061*^9}, {3.577565161754624*^9, 
   3.5775651631739902`*^9}, {3.577565201440604*^9, 3.577565238632525*^9}, {
   3.577565472807136*^9, 3.5775654730784273`*^9}, {3.577568578866701*^9, 
   3.577568608360729*^9}, {3.5892162186434193`*^9, 3.589216223945149*^9}, {
   3.5892162869935417`*^9, 3.589216463895852*^9}, 3.589216679532959*^9, {
   3.589217137430146*^9, 3.5892171393833923`*^9}, {3.589217892006131*^9, 
   3.589217904842271*^9}, {3.589217935281516*^9, 3.589217941987414*^9}, {
   3.5892181761504602`*^9, 3.589218178807778*^9}, {3.5892183393395853`*^9, 
   3.5892183462983847`*^9}, {3.589218581922073*^9, 3.5892185852202263`*^9}, {
   3.5892186444688177`*^9, 3.589218701633153*^9}, {3.589219479636712*^9, 
   3.589219618169076*^9}, {3.5892197233736153`*^9, 3.589219733258627*^9}, {
   3.589219831393962*^9, 3.5892198829921427`*^9}, 3.58922008215652*^9, 
   3.589220535142548*^9, {3.589220694960185*^9, 3.589220695269413*^9}, {
   3.589221055852799*^9, 3.589221059885447*^9}, {3.5892211997646923`*^9, 
   3.589221243367055*^9}, {3.589221288001933*^9, 3.589221303277895*^9}, {
   3.589221362801787*^9, 3.589221380893609*^9}, 3.58922162261966*^9, 
   3.58922168154362*^9, {3.589221717397427*^9, 3.589221756762992*^9}, {
   3.589222064781005*^9, 3.5892220839865828`*^9}, {3.5892221584324713`*^9, 
   3.5892221638011913`*^9}, {3.5892222350021048`*^9, 3.589222235264859*^9}, {
   3.5892227150978317`*^9, 3.589222716438669*^9}, 3.5892228836729*^9, {
   3.589287010269887*^9, 3.589287012349848*^9}, {3.589288869378212*^9, 
   3.58928887404452*^9}, {3.59009202430506*^9, 3.5900920245109577`*^9}, {
   3.5900921387127047`*^9, 3.5900921425817413`*^9}, {3.590092182782917*^9, 
   3.5900922338291597`*^9}, {3.5900922695607452`*^9, 3.590092269886437*^9}, {
   3.590092628300027*^9, 3.59009262859721*^9}, 3.590323323283421*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrthogonalPolynomialMatrixGeneratorConnectedAdaptive", "[", 
     RowBox[{"V_", ",", "N_", ",", 
      RowBox[{"M_:", "40"}], ",", 
      RowBox[{"L_:", "3."}], ",", 
      RowBox[{"expa_:", 
       RowBox[{"2", "/", "3"}]}], ",", 
      RowBox[{"expb_:", 
       RowBox[{"2", "/", "3"}]}], ",", 
      RowBox[{"shrink_:", "1"}], ",", 
      RowBox[{"inUP_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a\[Theta]", ",", "b\[Theta]", ",", "aScale", ",", "bScale", ",", 
        "adaptrhp", ",", "UP", ",", "rhp", ",", "smrngg", ",", "con", ",", 
        "Frac", ",", "USeries", ",", "min", ",", "supp", ",", "g", ",", "l", 
        ",", "ln", ",", "z", ",", "\[Phi]", ",", "P", ",", "Pin", ",", "rngg",
         ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", "B", ",", "AP", ",",
         "BP", ",", "gs", ",", "m", ",", "U", ",", "\[CapitalPsi]", ",", 
        "\[CapitalPhi]", ",", "p", ",", "slvr", ",", "Y", ",", "UD", ",", 
        "\[CapitalPsi]D", ",", "\[Phi]D", ",", "\[CapitalPhi]D", ",", "YD", 
        ",", "PD", ",", "BD", ",", "BinD", ",", "contours", ",", "base", ",", 
        "functions", ",", "points", ",", "y11", ",", "y21", ",", "yd21", ",", 
        "yd11", ",", "S", ",", "SD"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{
         RowBox[{
         "Y", " ", "is", " ", "only", " ", "accurate", " ", "for", " ", 
          RowBox[{"Im", "[", "z", "]"}]}], "\[GreaterEqual]", "0"}]}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"supp", "=", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "=", 
          RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"g", "//", "Clear"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", "z_", "]"}], "=", 
        RowBox[{"GFunction", "[", 
         RowBox[{"V", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"GFunction", "[", 
         RowBox[{
          RowBox[{"+", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"GFunction", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
           RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ln", "[", "n_", "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "l"}], " ", 
              RowBox[{"n", "/", "2"}]}], "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{"l", " ", 
              RowBox[{"n", "/", "2"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"min", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"a", "-", "b"}], "]"}], "/", "3"}], "*", 
         RowBox[{"1", "/", "shrink"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
         
         RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
         RowBox[{
          RowBox[{"g", "'"}], "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", "z_", "]"}], "=", 
        RowBox[{"Parametrix", "[", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {"0", "1"},
             {
              RowBox[{"-", "1"}], "0"}
            }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PD", "[", "z_", "]"}], "=", 
        RowBox[{
         RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"ParametrixBranch", "[", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {"0", "1"},
             {
              RowBox[{"-", "1"}], "0"}
            }], ")"}], ",", "supp", ",", "z", ",", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pin", "[", "z_", "]"}], "=", 
        RowBox[{"Inverse", "[", 
         RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pin", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"Inverse", "[", 
         RowBox[{"P", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "/.", 
             RowBox[{
              RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0."}]}]},
           {"0", "1"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "/.", 
             RowBox[{
              RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0."}]}], "1"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"P", "[", "z", "]"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
         RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"P", "[", "z", "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
         RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"UP", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"inUP", ",", "min"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"0", "0"},
           {
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"\[Phi]D", "[", "z", "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"0", "0"},
           {
            RowBox[{
             RowBox[{"-", "2"}], " ", "n", " ", 
             RowBox[{"\[Phi]D", "[", "z", "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rngg", "[", 
         RowBox[{"exp_", ",", "n_"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"min", "/", "2"}], ",", 
          RowBox[{"L", " ", 
           RowBox[{"n", "^", 
            RowBox[{"(", "exp", ")"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"smrngg", "[", 
         RowBox[{"\[Theta]_", ",", "exp_", ",", "n_"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"min", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"UP", "/", 
              RowBox[{"Abs", "[", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "]"}]}], 
             RowBox[{
              RowBox[{"n", "^", 
               RowBox[{"(", "exp", ")"}]}], "/", "2"}]}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"UP", "/", 
            RowBox[{"Abs", "[", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "]"}]}], 
           RowBox[{"n", "^", 
            RowBox[{"(", "exp", ")"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"base", "[", 
         RowBox[{"\[Theta]_", ",", "exp_", ",", "n_"}], "]"}], ":=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rngg", "[", 
           RowBox[{"exp", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "\[Theta]"}], "]"}], 
           RowBox[{"Reverse", "[", 
            RowBox[{"smrngg", "[", 
             RowBox[{"\[Theta]", ",", "exp", ",", "n"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}], 
           RowBox[{"Reverse", "[", 
            RowBox[{"smrngg", "[", 
             RowBox[{"\[Theta]", ",", "exp", ",", "n"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "\[Theta]"}], "]"}], " ", ",", "1"}], " ", 
            "}"}], 
           RowBox[{
            RowBox[{"rngg", "[", 
             RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", " ", ",", 
             RowBox[{"Exp", "[", " ", 
              RowBox[{
               RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}]}], " ", "}"}], 
           RowBox[{
            RowBox[{"rngg", "[", 
             RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", " ", 
              RowBox[{
               RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}], " ", ",", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", " ", "I"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "Pi"}], "-", "\[Theta]"}], ")"}]}], "]"}]}], 
            " ", "}"}], 
           RowBox[{
            RowBox[{"rngg", "[", 
             RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"contours", "[", 
         RowBox[{
         "m_", ",", "scale1_", ",", "scale2_", ",", "\[Theta]1_", ",", 
          "\[Theta]2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Line", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "+", 
                 RowBox[{
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"m", "^", 
                    RowBox[{"(", "scale1", ")"}]}], ")"}]}], " ", "#"}]}], 
                ")"}], "&"}], "/@", 
              RowBox[{"base", "[", 
               RowBox[{"\[Theta]1", ",", "scale1", ",", "m"}], "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"Line", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "-", 
                 RowBox[{
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"m", "^", 
                    RowBox[{"(", "scale2", ")"}]}], ")"}]}], " ", "#"}]}], 
                ")"}], "&"}], "/@", 
              RowBox[{"base", "[", 
               RowBox[{"\[Theta]2", ",", "scale2", ",", "m"}], "]"}]}], 
             ")"}]}]}], "]"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"functions", "[", "n_", "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"AP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"1", 
                RowBox[{"-", "1"}]},
               {"0", "1"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"0", 
                RowBox[{"-", "1"}]},
               {"1", "1"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"1", 
                RowBox[{"-", "1"}]},
               {"1", "0"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"1", "0"},
               {"1", "1"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", GridBox[{
               {"0", 
                RowBox[{"-", "1"}]},
               {"1", "0"}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"Pin", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"flag1_", ",", "flag2_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"M", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"flag1", ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", 
                RowBox[{"4", ";;", "5"}], "]"}], "]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "M"}], ",", 
                RowBox[{"2", "M"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"flag2", ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", 
                RowBox[{"10", ";;", "11"}], "]"}], "]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "M"}], ",", 
                RowBox[{"2", "M"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Add", " ", "connections", " ", "and", " ", "return", " ", "rhp"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rhp", "[", "n_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "out", ",", "\[Theta]a", ",", "scalea", ",", "s", ",", "\[Theta]b",
             ",", "scaleb", ",", "Jumps", ",", "Domains", ",", "NumPts", ",", 
            "start", ",", "end"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Jumps", "=", 
            RowBox[{"functions", "[", "n", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]a", ",", "scalea"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"Pi", "/", "3"}]}], ",", "expa"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]b", ",", "scaleb"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"\[Theta]a", ",", "expb"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"expa", "==", 
              RowBox[{"2", "/", "7"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Theta]a", ",", "scalea"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"6", 
                 RowBox[{"Pi", "/", "7"}]}], ",", 
                RowBox[{"2", "/", "7"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"expb", "==", 
              RowBox[{"2", "/", "7"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Theta]b", ",", "scaleb"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"6", 
                 RowBox[{"Pi", "/", "7"}]}], ",", 
                RowBox[{"2", "/", "7"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Domains", "=", 
            RowBox[{"contours", "[", 
             RowBox[{
             "n", ",", "scaleb", ",", "scalea", ",", "\[Theta]b", ",", 
              "\[Theta]a"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"NumPts", "=", 
            RowBox[{"points", "[", 
             RowBox[{
              RowBox[{"expb", "==", 
               RowBox[{"2", "/", "7"}]}], ",", 
              RowBox[{"expa", "==", 
               RowBox[{"2", "/", "7"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"start", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Domains", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"end", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Domains", "[", 
               RowBox[{"[", "9", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Domains", "=", 
            RowBox[{"Domains", "~", "Join", "~", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"start", ",", "end"}], "}"}], "//", "Reverse"}], 
                "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"start", ",", "end"}], "}"}], "//", "Conjugate"}], 
                 "//", "Reverse"}], "]"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Jumps", "=", 
            RowBox[{"Jumps", "~", "Join", "~", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"BP", "[", "n", "]"}], ",", 
               RowBox[{"BP", "[", "n", "]"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NumPts", "=", 
            RowBox[{"NumPts", "~", "Join", "~", 
             RowBox[{"{", 
              RowBox[{"M", ",", "M"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"adaptrhp", "[", "n_", "]"}], ":=", 
        RowBox[{
         RowBox[{"adaptrhp", "[", "n", "]"}], "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"step", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"step", "=", 
             RowBox[{".001", "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"out", "=", 
             RowBox[{
              RowBox[{"Adapt", "[", 
               RowBox[{
                RowBox[{"rhp", "[", "n", "]"}], ",", 
                RowBox[{"10.", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "14"}], ")"}]}], ",", "step"}], "]"}], "[", 
              RowBox[{"rhp", "[", "n", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", "8"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"step", "=", 
                RowBox[{"step", "/", "2"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "step", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"out", "=", 
                RowBox[{
                 RowBox[{"Adapt", "[", 
                  RowBox[{
                   RowBox[{"rhp", "[", "n", "]"}], ",", 
                   RowBox[{"10.", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "14"}], ")"}]}], ",", "step"}], "]"}], "[", 
                 RowBox[{"rhp", "[", "n", "]"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "out"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"U", "[", "n_", "]"}], ":=", 
        RowBox[{
         RowBox[{"U", "[", "n", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"adaptrhp", "[", "n", "]"}], "//", "MakeListFun"}], "//", 
          "RHSolve"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"USeries", "[", "n_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "Pi", " ", "I"}], ")"}]}], " ", 
         RowBox[{"DomainIntegrate", "[", 
          RowBox[{"U", "[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
          RowBox[{"Cauchy", "[", 
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aScale", "[", "n_", "]"}], ":=", " ", 
        RowBox[{"n", "^", "expa"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bScale", "[", "n_", "]"}], ":=", " ", 
        RowBox[{"n", "^", "expb"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a\[Theta]", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"expa", "\[Equal]", 
           RowBox[{"2", "/", "7"}]}], ",", 
          RowBox[{"6", 
           RowBox[{"Pi", "/", "7"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"Pi", "/", "3"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"b\[Theta]", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"expb", "\[Equal]", 
           RowBox[{"2", "/", "7"}]}], ",", 
          RowBox[{"6", 
           RowBox[{"Pi", "/", "7"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"Pi", "/", "3"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], " ", "]"}], "&&", 
          
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", "b\[Theta]"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expb", ",", "n"}], "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
               RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
          RowBox[{"b\[Theta]", "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expb", ",", "n"}], "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
               RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{"-", "b\[Theta]"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], " ", "]"}], " ", "&&", 
          RowBox[{
           RowBox[{"-", "b\[Theta]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expa", ",", "n"}], "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
               RowBox[{"aScale", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
           RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}], "]"}]}], "]"}], " ", "&&", 
          " ", 
          RowBox[{
           RowBox[{"\[Pi]", "-", "a\[Theta]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], "/", 
               RowBox[{"aScale", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], 
          " ", "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expa", ",", "n"}], "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
               RowBox[{"aScale", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{"b\[Theta]", "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
          RowBox[{
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{"-", "b\[Theta]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Y", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"n", ",", "z"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "z"}], "]"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}]}
              }], ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "=", 
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y21", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"n", ",", "z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{"l", "-", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "/", "2"}], "+", 
             RowBox[{"g", "[", "z", "]"}]}], ")"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y11", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"n", ",", "z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", "[", "z", "]"}], "-", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "/", "2"}]}], ")"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"CauchyD", "[", 
         RowBox[{
          RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ";", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", "b\[Theta]"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
               RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
          RowBox[{"b\[Theta]", "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {
              RowBox[{"-", "1"}], "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", "0"},
              {
               RowBox[{"-", "1"}], "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
               RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{"-", "b\[Theta]"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "1"}
             }], ")"}], " ", ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
          RowBox[{
           RowBox[{"-", "b\[Theta]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"0", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"0", "1"}
             }], ")"}], " ", ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
               RowBox[{"aScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
          RowBox[{
           RowBox[{"\[Pi]", "-", "a\[Theta]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {"1", "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", "0"},
              {"1", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], "/", 
               RowBox[{"aScale", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rngg", "[", 
                RowBox[{"expb", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
               RowBox[{"aScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"P", "[", "z", "]"}]}], "+", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{"b\[Theta]", "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{
           RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
          RowBox[{
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{"-", "b\[Theta]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{
           RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", 
       RowBox[{
        RowBox[{"YD", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"YD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"\[CapitalPhi]D", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}]}
             }], ")"}]}], "+", 
          RowBox[{"n", " ", 
           RowBox[{
            RowBox[{"g", "'"}], "[", "z", "]"}], " ", 
           RowBox[{
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "z"}], "]"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"g", "[", "z", "]"}]}], "]"}]}]}
              }], ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SD", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"SD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "=", 
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"yd21", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"SD", "[", 
             RowBox[{"n", ",", "z"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"n", " ", 
            RowBox[{
             RowBox[{"g", "'"}], "[", "z", "]"}], 
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"n", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{"l", "-", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "/", "2"}], "+", 
             RowBox[{"g", "[", "z", "]"}]}], ")"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"yd11", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"SD", "[", 
             RowBox[{"n", ",", "z"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"n", " ", 
            RowBox[{
             RowBox[{"g", "'"}], "[", "z", "]"}], 
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"n", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", "[", "z", "]"}], "-", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "/", "2"}]}], ")"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Y", ",", "YD", ",", "U", ",", "USeries", ",", "ln", ",", 
         RowBox[{
          RowBox[{"MakeListFun", "[", 
           RowBox[{"adaptrhp", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"MakeListFun", "[", 
           RowBox[{"rhp", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"y11", ",", "y21"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yd11", ",", "yd21"}], "}"}]}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrthogonalPolynomialMatrixGeneratorForCoefficients", "[", 
    RowBox[{"V_", ",", "N_", ",", 
     RowBox[{"M_:", "40"}], ",", 
     RowBox[{"L_:", "3."}], ",", 
     RowBox[{"expa_:", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"expb_:", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"shrink_:", "1"}], ",", 
     RowBox[{"inUP_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a\[Theta]", ",", "b\[Theta]", ",", "aScale", ",", "bScale", ",", 
       "adaptrhp", ",", "UP", ",", "rhp", ",", "smrngg", ",", "con", ",", 
       "Frac", ",", "USeries", ",", "min", ",", "supp", ",", "g", ",", "l", 
       ",", "ln", ",", "z", ",", "\[Phi]", ",", "P", ",", "Pin", ",", "rngg", 
       ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", "B", ",", "AP", ",", 
       "BP", ",", "gs", ",", "m", ",", "U", ",", "\[CapitalPsi]", ",", 
       "\[CapitalPhi]", ",", "p", ",", "slvr", ",", "Y", ",", "UD", ",", 
       "\[CapitalPsi]D", ",", "\[Phi]D", ",", "\[CapitalPhi]D", ",", "YD", 
       ",", "PD", ",", "BD", ",", "BinD", ",", "contours", ",", "base", ",", 
       "functions", ",", "points", ",", "y11", ",", "y21", ",", "yd21", ",", 
       "yd11", ",", "S", ",", "SD"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{
        RowBox[{"Y", " ", "is", " ", "only", " ", "accurate", " ", "for", " ", 
         RowBox[{"Im", "[", "z", "]"}]}], "\[GreaterEqual]", "0"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"supp", "=", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=", 
         RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g", "//", "Clear"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", "z_", "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{"V", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
          RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ln", "[", "n_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "l"}], " ", 
             RowBox[{"n", "/", "2"}]}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Exp", "[", 
            RowBox[{"l", " ", 
             RowBox[{"n", "/", "2"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"a", "-", "b"}], "]"}], "/", "3"}], "*", 
        RowBox[{"1", "/", "shrink"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
        RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
        RowBox[{
         RowBox[{"g", "'"}], "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", "z_", "]"}], "=", 
       RowBox[{"Parametrix", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PD", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"ParametrixBranch", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z", ",", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", "z_", "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0."}]}]},
          {"0", "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0."}]}], "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "inUP", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"UP", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"inUP", ",", "min"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rngg", "[", 
        RowBox[{"exp_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"min", "/", "2"}], ",", 
         RowBox[{"L", " ", 
          RowBox[{"n", "^", 
           RowBox[{"(", "exp", ")"}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"smrngg", "[", 
        RowBox[{"\[Theta]_", ",", "exp_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"min", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"UP", "/", 
             RowBox[{"Abs", "[", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "]"}]}], 
            RowBox[{
             RowBox[{"n", "^", 
              RowBox[{"(", "exp", ")"}]}], "/", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"UP", "/", 
           RowBox[{"Abs", "[", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "]"}]}], 
          RowBox[{"n", "^", 
           RowBox[{"(", "exp", ")"}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"base", "[", 
        RowBox[{"\[Theta]_", ",", "exp_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rngg", "[", 
          RowBox[{"exp", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "\[Theta]"}], "]"}], 
          RowBox[{"Reverse", "[", 
           RowBox[{"smrngg", "[", 
            RowBox[{"\[Theta]", ",", "exp", ",", "n"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}], 
          RowBox[{"Reverse", "[", 
           RowBox[{"smrngg", "[", 
            RowBox[{"\[Theta]", ",", "exp", ",", "n"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "\[Theta]"}], "]"}], " ", ",", "1"}], " ", 
           "}"}], 
          RowBox[{
           RowBox[{"rngg", "[", 
            RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", " ", ",", 
            RowBox[{"Exp", "[", " ", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}]}], " ", "}"}], 
          RowBox[{
           RowBox[{"rngg", "[", 
            RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", " ", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}], " ", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", " ", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "Pi"}], "-", "\[Theta]"}], ")"}]}], "]"}]}], " ",
            "}"}], 
          RowBox[{
           RowBox[{"rngg", "[", 
            RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"contours", "[", 
        RowBox[{
        "m_", ",", "scale1_", ",", "scale2_", ",", "\[Theta]1_", ",", 
         "\[Theta]2_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Line", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", "+", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"m", "^", 
                    RowBox[{"(", "scale1", ")"}]}], ")"}]}], " ", "#"}]}], 
               ")"}], "&"}], "/@", 
             RowBox[{"base", "[", 
              RowBox[{"\[Theta]1", ",", "scale1", ",", "m"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"Line", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"a", "-", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"m", "^", 
                    RowBox[{"(", "scale2", ")"}]}], ")"}]}], " ", "#"}]}], 
               ")"}], "&"}], "/@", 
             RowBox[{"base", "[", 
              RowBox[{"\[Theta]2", ",", "scale2", ",", "m"}], "]"}]}], 
            ")"}]}]}], "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"functions", "[", "n_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"0", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"1", "0"},
              {"1", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"flag1_", ",", "flag2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"M", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"flag1", ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "M"}], ",", 
               RowBox[{"2", "M"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"flag2", ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"10", ";;", "11"}], "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "M"}], ",", 
               RowBox[{"2", "M"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Add", " ", "connections", " ", "and", " ", "return", " ", "rhp"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhp", "[", "n_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "out", ",", "\[Theta]a", ",", "scalea", ",", "s", ",", "\[Theta]b", 
           ",", "scaleb", ",", "Jumps", ",", "Domains", ",", "NumPts", ",", 
           "start", ",", "end"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Jumps", "=", 
           RowBox[{"functions", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]a", ",", "scalea"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"Pi", "/", "3"}]}], ",", "expa"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]b", ",", "scaleb"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{"\[Theta]a", ",", "expb"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"expa", "==", 
             RowBox[{"2", "/", "7"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]a", ",", "scalea"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"6", 
                RowBox[{"Pi", "/", "7"}]}], ",", 
               RowBox[{"2", "/", "7"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"expb", "==", 
             RowBox[{"2", "/", "7"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]b", ",", "scaleb"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"6", 
                RowBox[{"Pi", "/", "7"}]}], ",", 
               RowBox[{"2", "/", "7"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Domains", "=", 
           RowBox[{"contours", "[", 
            RowBox[{
            "n", ",", "scaleb", ",", "scalea", ",", "\[Theta]b", ",", 
             "\[Theta]a"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"NumPts", "=", 
           RowBox[{"points", "[", 
            RowBox[{
             RowBox[{"expb", "==", 
              RowBox[{"2", "/", "7"}]}], ",", 
             RowBox[{"expa", "==", 
              RowBox[{"2", "/", "7"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"start", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Domains", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"end", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Domains", "[", 
              RowBox[{"[", "9", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Domains", "=", 
           RowBox[{"Domains", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"start", ",", "end"}], "}"}], "//", "Reverse"}], 
               "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"start", ",", "end"}], "}"}], "//", "Conjugate"}], "//",
                 "Reverse"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Jumps", "=", 
           RowBox[{"Jumps", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"BP", "[", "n", "]"}], ",", 
              RowBox[{"BP", "[", "n", "]"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NumPts", "=", 
           RowBox[{"NumPts", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"M", ",", "M"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"adaptrhp", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"adaptrhp", "[", "n", "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"step", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"step", "=", 
            RowBox[{".001", "/", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"out", "=", 
            RowBox[{
             RowBox[{"Adapt", "[", 
              RowBox[{
               RowBox[{"rhp", "[", "n", "]"}], ",", 
               RowBox[{"10.", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "14"}], ")"}]}], ",", "step"}], "]"}], "[", 
             RowBox[{"rhp", "[", "n", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"out", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", "8"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"step", "=", 
               RowBox[{"step", "/", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "step", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"out", "=", 
               RowBox[{
                RowBox[{"Adapt", "[", 
                 RowBox[{
                  RowBox[{"rhp", "[", "n", "]"}], ",", 
                  RowBox[{"10.", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "14"}], ")"}]}], ",", "step"}], "]"}], "[", 
                RowBox[{"rhp", "[", "n", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "out"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", "n", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"adaptrhp", "[", "n", "]"}], "//", "MakeListFun"}], "//", 
         "RHSolve"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"USeries", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "Pi", " ", "I"}], ")"}]}], " ", 
        RowBox[{"DomainIntegrate", "[", 
         RowBox[{"U", "[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
         RowBox[{"Cauchy", "[", 
          RowBox[{
           RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aScale", "[", "n_", "]"}], ":=", " ", 
       RowBox[{"n", "^", "expa"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bScale", "[", "n_", "]"}], ":=", " ", 
       RowBox[{"n", "^", "expb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a\[Theta]", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"expa", "\[Equal]", 
          RowBox[{"2", "/", "7"}]}], ",", 
         RowBox[{"6", 
          RowBox[{"Pi", "/", "7"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "3"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b\[Theta]", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"expb", "\[Equal]", 
          RowBox[{"2", "/", "7"}]}], ",", 
         RowBox[{"6", 
          RowBox[{"Pi", "/", "7"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "3"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], " ", "]"}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "b\[Theta]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{"-", "1"}], "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], " ", "]"}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "b\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"0", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expa", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"aScale", "[", "n", "]"}]}], "]"}]}], "]"}], " ", "&&", 
         " ", 
         RowBox[{
          RowBox[{"\[Pi]", "-", "a\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], " ",
          "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expa", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}], "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Y", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"n", ",", "z"}], "]"}], "=", 
          RowBox[{
           RowBox[{"\[CapitalPhi]", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}]}
             }], ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y21", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"l", "-", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "/", "2"}], "+", 
            RowBox[{"g", "[", "z", "]"}]}], ")"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y11", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", "[", "z", "]"}], "-", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "/", "2"}]}], ")"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"CauchyD", "[", 
        RowBox[{
         RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "b\[Theta]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {
              RowBox[{"-", "1"}], "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"-", "b\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"0", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"aScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"\[Pi]", "-", "a\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {"1", "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"P", "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}], "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"YD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"YD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"\[CapitalPhi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{
           RowBox[{"g", "'"}], "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"\[CapitalPhi]", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"SD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yd21", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"SD", "[", 
            RowBox[{"n", ",", "z"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"n", " ", 
           RowBox[{
            RowBox[{"g", "'"}], "[", "z", "]"}], 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"n", ",", "z"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"l", "-", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "/", "2"}], "+", 
            RowBox[{"g", "[", "z", "]"}]}], ")"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yd11", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"SD", "[", 
            RowBox[{"n", ",", "z"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"n", " ", 
           RowBox[{
            RowBox[{"g", "'"}], "[", "z", "]"}], 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"n", ",", "z"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", "[", "z", "]"}], "-", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "/", "2"}]}], ")"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Y", ",", "YD", ",", "U", ",", "USeries", ",", "ln", ",", 
        RowBox[{
         RowBox[{"MakeListFun", "[", 
          RowBox[{"adaptrhp", "[", "#", "]"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"MakeListFun", "[", 
          RowBox[{"rhp", "[", "#", "]"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y11", ",", "y21"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"yd11", ",", "yd21"}], "}"}]}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mGFunction", "[", 
    RowBox[{"V_", ",", "supp_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"CauchyInverseIntegral", "[", 
    RowBox[{
     RowBox[{"Fun", "[", 
      RowBox[{
       RowBox[{"V", "'"}], ",", 
       RowBox[{"Line", "[", "supp", "]"}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mDGFunction", "[", 
    RowBox[{"V_", ",", "supp_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"CauchyInverse", "[", 
    RowBox[{
     RowBox[{"Fun", "[", 
      RowBox[{
       RowBox[{"V", "'"}], ",", 
       RowBox[{"Line", "[", "supp", "]"}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mGFunction", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", "V_", ",", "supp_", ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{"CauchyInverseIntegralS", "[", 
    RowBox[{"s", ",", 
     RowBox[{"Fun", "[", 
      RowBox[{
       RowBox[{"V", "'"}], ",", 
       RowBox[{"Line", "[", "supp", "]"}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrthogonalPolynomialMatrixGeneratorForRoots", "[", 
    RowBox[{"V_", ",", "N_", ",", 
     RowBox[{"M_:", "40"}], ",", 
     RowBox[{"L_:", "3."}], ",", 
     RowBox[{"expa_:", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"expb_:", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"shrink_:", "1"}], ",", 
     RowBox[{"inUP_:", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a\[Theta]", ",", "b\[Theta]", ",", "gD", ",", "aScale", ",", "bScale", 
       ",", "adaptrhp", ",", "UP", ",", "rhp", ",", "smrngg", ",", "con", ",",
        "Frac", ",", "USeries", ",", "min", ",", "supp", ",", "g", ",", "l", 
       ",", "ln", ",", "z", ",", "\[Phi]", ",", "P", ",", "Pin", ",", "rngg", 
       ",", "F", ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", "Ue", ",", 
       "B", ",", "AP", ",", "BP", ",", "gs", ",", "m", ",", "U", ",", 
       "\[CapitalPhi]", ",", "p", ",", "slvr", ",", "Y", ",", "UD", ",", 
       "\[Phi]D", ",", "\[CapitalPhi]D", ",", "YD", ",", "PD", ",", "BD", ",",
        "funs", ",", "funsd", ",", "am", ",", "bm", ",", "ap", ",", "bp", ",",
        "BinD", ",", "UC", ",", "contours", ",", "base", ",", "functions", 
       ",", "points", ",", "y11", ",", "y21", ",", "yd21", ",", "yd11", ",", 
       "S", ",", "SD", ",", "UDC", ",", "EvalFun", ",", "Uo", ",", "UCo", ",",
        "UDCo", ",", "EvalFunD", ",", "Y2", ",", "Y2D", ",", "\[CapitalPsi]", 
       ",", "\[CapitalPsi]D"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{
        RowBox[{"Y", " ", "is", " ", "only", " ", "accurate", " ", "for", " ", 
         RowBox[{"Im", "[", "z", "]"}]}], "\[GreaterEqual]", "0"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"supp", "=", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=", 
         RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"g", "[", "z", "]"}], "=", 
        RowBox[{"mGFunction", "[", 
         RowBox[{"V", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", "z"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gD", "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"gD", "[", "z", "]"}], "=", 
        RowBox[{"mDGFunction", "[", 
         RowBox[{"V", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", "z"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], ":=", 
       RowBox[{"mGFunction", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "V", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], ":=", 
       RowBox[{"mGFunction", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "V", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"g", "[", "z_", "]"}], "=", 
         RowBox[{"GFunction", "[", 
          RowBox[{"V", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
         RowBox[{"GFunction", "[", 
          RowBox[{
           RowBox[{"+", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
         RowBox[{"GFunction", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "V", ",", "z"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
          RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ln", "[", "n_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "l"}], " ", 
             RowBox[{"n", "/", "2"}]}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Exp", "[", 
            RowBox[{"l", " ", 
             RowBox[{"n", "/", "2"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"a", "-", "b"}], "]"}], "/", "3"}], "*", 
        RowBox[{"1", "/", "shrink"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
        RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
        RowBox[{"gD", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", "z_", "]"}], "=", 
       RowBox[{"Parametrix", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PD", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"ParametrixBranch", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z", ",", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", "z_", "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0."}]}]},
          {"0", "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0."}]}], "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"UP", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"inUP", ",", "min"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rngg", "[", 
        RowBox[{"exp_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"min", "/", "2"}], ",", 
         RowBox[{"L", " ", 
          RowBox[{"n", "^", 
           RowBox[{"(", "exp", ")"}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"smrngg", "[", 
        RowBox[{"\[Theta]_", ",", "exp_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"min", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"UP", "/", 
             RowBox[{"Abs", "[", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "]"}]}], 
            RowBox[{
             RowBox[{"n", "^", 
              RowBox[{"(", "exp", ")"}]}], "/", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"UP", "/", 
           RowBox[{"Abs", "[", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "]"}]}], 
          RowBox[{"n", "^", 
           RowBox[{"(", "exp", ")"}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"base", "[", 
        RowBox[{"\[Theta]_", ",", "exp_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rngg", "[", 
          RowBox[{"exp", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "\[Theta]"}], "]"}], 
          RowBox[{"Reverse", "[", 
           RowBox[{"smrngg", "[", 
            RowBox[{"\[Theta]", ",", "exp", ",", "n"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}], 
          RowBox[{"Reverse", "[", 
           RowBox[{"smrngg", "[", 
            RowBox[{"\[Theta]", ",", "exp", ",", "n"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "\[Theta]"}], "]"}], " ", ",", "1"}], " ", 
           "}"}], 
          RowBox[{
           RowBox[{"rngg", "[", 
            RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", " ", ",", 
            RowBox[{"Exp", "[", " ", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}]}], " ", "}"}], 
          RowBox[{
           RowBox[{"rngg", "[", 
            RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", " ", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}], " ", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", " ", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "Pi"}], "-", "\[Theta]"}], ")"}]}], "]"}]}], " ",
            "}"}], 
          RowBox[{
           RowBox[{"rngg", "[", 
            RowBox[{"exp", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"contours", "[", 
        RowBox[{
        "m_", ",", "scale1_", ",", "scale2_", ",", "\[Theta]1_", ",", 
         "\[Theta]2_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Line", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", "+", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"m", "^", 
                    RowBox[{"(", "scale1", ")"}]}], ")"}]}], " ", "#"}]}], 
               ")"}], "&"}], "/@", 
             RowBox[{"base", "[", 
              RowBox[{"\[Theta]1", ",", "scale1", ",", "m"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"Line", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"a", "-", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"m", "^", 
                    RowBox[{"(", "scale2", ")"}]}], ")"}]}], " ", "#"}]}], 
               ")"}], "&"}], "/@", 
             RowBox[{"base", "[", 
              RowBox[{"\[Theta]2", ",", "scale2", ",", "m"}], "]"}]}], 
            ")"}]}]}], "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"functions", "[", "n_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BP", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"0", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"1", "0"},
              {"1", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"Pin", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"flag1_", ",", "flag2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"M", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"flag1", ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "M"}], ",", 
               RowBox[{"2", "M"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"flag2", ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"10", ";;", "11"}], "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "M"}], ",", 
               RowBox[{"2", "M"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Add", " ", "connections", " ", "and", " ", "return", " ", "rhp"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhp", "[", "n_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "out", ",", "\[Theta]a", ",", "scalea", ",", "s", ",", "\[Theta]b", 
           ",", "scaleb", ",", "Jumps", ",", "Domains", ",", "NumPts", ",", 
           "start", ",", "end"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Jumps", "=", 
           RowBox[{"functions", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]a", ",", "scalea"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"Pi", "/", "3"}]}], ",", "expa"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]b", ",", "scaleb"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{"\[Theta]a", ",", "expb"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"expa", "==", 
             RowBox[{"2", "/", "7"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]a", ",", "scalea"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"6", 
                RowBox[{"Pi", "/", "7"}]}], ",", 
               RowBox[{"2", "/", "7"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"expb", "==", 
             RowBox[{"2", "/", "7"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]b", ",", "scaleb"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"6", 
                RowBox[{"Pi", "/", "7"}]}], ",", 
               RowBox[{"2", "/", "7"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Domains", "=", 
           RowBox[{"contours", "[", 
            RowBox[{
            "n", ",", "scaleb", ",", "scalea", ",", "\[Theta]b", ",", 
             "\[Theta]a"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"NumPts", "=", 
           RowBox[{"points", "[", 
            RowBox[{
             RowBox[{"expb", "==", 
              RowBox[{"2", "/", "7"}]}], ",", 
             RowBox[{"expa", "==", 
              RowBox[{"2", "/", "7"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"start", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Domains", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"end", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Domains", "[", 
              RowBox[{"[", "9", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Domains", "=", 
           RowBox[{"Domains", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"start", ",", "end"}], "}"}], "//", "Reverse"}], 
               "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"start", ",", "end"}], "}"}], "//", "Conjugate"}], "//",
                 "Reverse"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Jumps", "=", 
           RowBox[{"Jumps", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"BP", "[", "n", "]"}], ",", 
              RowBox[{"BP", "[", "n", "]"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NumPts", "=", 
           RowBox[{"NumPts", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"M", ",", "M"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"adaptrhp", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"adaptrhp", "[", "n", "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"step", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"step", "=", 
            RowBox[{".001", "/", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"out", "=", 
            RowBox[{
             RowBox[{"Adapt", "[", 
              RowBox[{
               RowBox[{"rhp", "[", "n", "]"}], ",", 
               RowBox[{"10.", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "14"}], ")"}]}], ",", "step"}], "]"}], "[", 
             RowBox[{"rhp", "[", "n", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"out", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", "8"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"step", "=", 
               RowBox[{"step", "/", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "step", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"out", "=", 
               RowBox[{
                RowBox[{"Adapt", "[", 
                 RowBox[{
                  RowBox[{"rhp", "[", "n", "]"}], ",", 
                  RowBox[{"10.", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "14"}], ")"}]}], ",", "step"}], "]"}], "[", 
                RowBox[{"rhp", "[", "n", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "out"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"x_", ",", "funs_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "funs", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Domain", "[", 
                   RowBox[{"funs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "x", 
                "\[LessEqual]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Domain", "[", 
                   RowBox[{"funs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Return", "[", 
                 RowBox[{
                  RowBox[{"funs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "x", "]"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "0.", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", "n", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"adaptrhp", "[", "n", "]"}], "//", "MakeListFun"}], "//", 
         "RHSolve"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"USeries", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "Pi", " ", "I"}], ")"}]}], 
        RowBox[{"DomainIntegrate", "[", 
         RowBox[{"U", "[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"Ue", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Ue", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"U", "[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Uo", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Uo", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "All"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"U", "[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UC", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], "+", 
        RowBox[{"Cauchy", "[", 
         RowBox[{
          RowBox[{"Ue", "[", "n", "]"}], ",", "z"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UCo", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"UCo", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "+", 
         RowBox[{"Cauchy", "[", 
          RowBox[{
           RowBox[{"Uo", "[", "n", "]"}], ",", "z"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bp", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", "[", "n", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", "Points"}], "//", "First"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bm", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"U", "[", "n", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "//", "Points"}], "//", "Last"}], "//",
         "Re"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ap", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", "[", "n", "]"}], "[", 
          RowBox[{"[", "7", "]"}], "]"}], "//", "Points"}], "//", "First"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"am", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"U", "[", "n", "]"}], "[", 
           RowBox[{"[", "8", "]"}], "]"}], "//", "Points"}], "//", "Last"}], "//",
         "Re"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"funs", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"funs", "[", "n", "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "A1", ",", "B1", ",", "A2", ",", "B2", ",", "A3", ",", "B3", ",", 
            "A4", ",", "B4", ",", "A5", ",", "B5", ",", "A6", ",", "B6"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A1", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", 
                  RowBox[{
                   RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], ",", "0"}], 
                "}"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"A2", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}], ",", 
                 RowBox[{"3", 
                  RowBox[{
                   RowBox[{"am", "[", "n", "]"}], "/", "4"}]}]}], "}"}], 
               "]"}], ",", "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A3", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}]}], "}"}], "]"}], ",", 
              "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A4", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}]}], "}"}], "]"}], ",", 
              "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A5", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"am", "[", "n", "]"}], "+", 
                  RowBox[{"10", "$MachineEpsilon"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                  RowBox[{"am", "[", "n", "]"}]}]}], "}"}], "]"}], ",", 
              "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A6", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a", "+", 
                    RowBox[{"ap", "[", "n", "]"}]}], ")"}], "/", "2"}], ",", 
                 RowBox[{
                  RowBox[{"am", "[", "n", "]"}], "-", 
                  RowBox[{"10", " ", "$MachineEpsilon"}]}]}], "}"}], "]"}], 
              ",", "small"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"B1", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], ",", "0"}], 
                 "}"}], "//", "Reverse"}], "]"}], ",", "large"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"B2", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}], ",", 
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}]}], "}"}], "//",
                 "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B3", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B4", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B5", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"bm", "[", "n", "]"}], "-", 
                   RowBox[{"10", "$MachineEpsilon"}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"bm", "[", "n", "]"}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B6", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"b", "+", 
                    RowBox[{"bp", "[", "n", "]"}]}], ")"}], "/", "2"}], ",", 
                  RowBox[{
                   RowBox[{"bm", "[", "n", "]"}], "+", 
                   RowBox[{"10", " ", "$MachineEpsilon"}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "small"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "A1", ",", "A2", ",", "A3", ",", "A4", ",", "A5", ",", "A6", ",", 
             "B1", ",", "B2", ",", "B3", ",", "B4", ",", "B5", ",", "B6"}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Im", "[", "z", "]"}], "\[Equal]", "0."}], "&&", 
           RowBox[{"(", 
            RowBox[{"a", "\[LessEqual]", "z", "\[LessEqual]", "b"}], ")"}]}], 
          ",", 
          RowBox[{"F", "[", 
           RowBox[{"z", ",", 
            RowBox[{"funs", "[", "n", "]"}]}], "]"}], ",", 
          RowBox[{"UC", "[", 
           RowBox[{"n", ",", "z"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aScale", "[", "n_", "]"}], ":=", " ", 
       RowBox[{"n", "^", "expa"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bScale", "[", "n_", "]"}], ":=", " ", 
       RowBox[{"n", "^", "expb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a\[Theta]", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"expa", "\[Equal]", 
          RowBox[{"2", "/", "7"}]}], ",", 
         RowBox[{"6", 
          RowBox[{"Pi", "/", "7"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "3"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b\[Theta]", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"expb", "\[Equal]", 
          RowBox[{"2", "/", "7"}]}], ",", 
         RowBox[{"6", 
          RowBox[{"Pi", "/", "7"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "3"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], " ", "]"}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "b\[Theta]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{"-", "1"}], "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], " ", "]"}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "b\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"0", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expa", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"aScale", "[", "n", "]"}]}], "]"}]}], "]"}], " ", "&&", 
         " ", 
         RowBox[{
          RowBox[{"\[Pi]", "-", "a\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], " ",
          "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expa", ",", "n"}], "]"}], "\[LeftDoubleBracket]", "1",
               "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z", ",", "U"}], "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}], "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z", ",", "U"}], "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", 
        RowBox[{"n_", ",", "z_", ",", "U_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n", ",", "z", ",", "U"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n", ",", "z", ",", "U"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"n", " ", 
               RowBox[{"g", "[", "z", "]"}]}], "+", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"g", "[", "z", "]"}]}], "-", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y2", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n", ",", "z", ",", "UCo"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"n", " ", 
               RowBox[{"g", "[", "z", "]"}]}], "+", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"g", "[", "z", "]"}]}], "-", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UDC", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"CauchyD", "[", 
        RowBox[{
         RowBox[{"Ue", "[", "n", "]"}], ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UDCo", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"UDCo", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{"CauchyD", "[", 
         RowBox[{
          RowBox[{"Uo", "[", "n", "]"}], ",", "z"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"funsd", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"funsd", "[", "n", "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "A1", ",", "B1", ",", "A2", ",", "B2", ",", "A3", ",", "B3", ",", 
            "A4", ",", "B4", ",", "A5", ",", "B5", ",", "A6", ",", "B6"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A1", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", 
                  RowBox[{
                   RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], ",", "0"}], 
                "}"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"A2", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}], ",", 
                 RowBox[{"3", 
                  RowBox[{
                   RowBox[{"am", "[", "n", "]"}], "/", "4"}]}]}], "}"}], 
               "]"}], ",", "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A3", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}]}], "}"}], "]"}], ",", 
              "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A4", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"am", "[", "n", "]"}], "/", "4"}]}], "+", 
                  RowBox[{
                   RowBox[{"1", "/", "4"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"am", "[", "n", "]"}]}]}]}], "}"}], "]"}], ",", 
              "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A5", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"am", "[", "n", "]"}], "+", 
                  RowBox[{"10", "$MachineEpsilon"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                  RowBox[{"am", "[", "n", "]"}]}]}], "}"}], "]"}], ",", 
              "large"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"A6", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a", "+", 
                    RowBox[{"ap", "[", "n", "]"}]}], ")"}], "/", "2"}], ",", 
                 RowBox[{
                  RowBox[{"am", "[", "n", "]"}], "-", 
                  RowBox[{"10", " ", "$MachineEpsilon"}]}]}], "}"}], "]"}], 
              ",", "small"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"B1", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], ",", "0"}], 
                 "}"}], "//", "Reverse"}], "]"}], ",", "large"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"B2", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}], ",", 
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}]}], "}"}], "//",
                 "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B3", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".4", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B4", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"3", 
                    RowBox[{
                    RowBox[{"bm", "[", "n", "]"}], "/", "4"}]}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "4"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".2", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"2", "/", "6"}], ")"}]}]}]}], ")"}], 
                    RowBox[{"bm", "[", "n", "]"}]}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B5", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"bm", "[", "n", "]"}], "-", 
                   RowBox[{"10", "$MachineEpsilon"}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{".1", "/", 
                    RowBox[{"n", "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "6"}], ")"}]}]}]}], ")"}], 
                   RowBox[{"bm", "[", "n", "]"}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "large"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B6", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UDC", "[", 
                RowBox[{"n", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"b", "+", 
                    RowBox[{"bp", "[", "n", "]"}]}], ")"}], "/", "2"}], ",", 
                  RowBox[{
                   RowBox[{"bm", "[", "n", "]"}], "+", 
                   RowBox[{"10", " ", "$MachineEpsilon"}]}]}], "}"}], "//", 
                "Reverse"}], "]"}], ",", "small"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "A1", ",", "A2", ",", "A3", ",", "A4", ",", "A5", ",", "A6", ",", 
             "B1", ",", "B2", ",", "B3", ",", "B4", ",", "B5", ",", "B6"}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Im", "[", "z", "]"}], "\[Equal]", "0."}], "&&", 
           RowBox[{"(", 
            RowBox[{"a", "\[LessEqual]", "z", "\[LessEqual]", "b"}], ")"}]}], 
          ",", 
          RowBox[{"F", "[", 
           RowBox[{"z", ",", 
            RowBox[{"funsd", "[", "n", "]"}]}], "]"}], ",", 
          RowBox[{"UDC", "[", 
           RowBox[{"n", ",", "z"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "b\[Theta]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {
              RowBox[{"-", "1"}], "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "b\[Theta]"}], "]"}], "/", 
              RowBox[{"bScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"b\[Theta]", ",", "expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"bScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"-", "b\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"0", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "/", 
             RowBox[{"aScale", "[", "n", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"\[Pi]", "-", "a\[Theta]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {"1", "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"a\[Theta]", ",", "expa", ",", "n"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rngg", "[", 
               RowBox[{"expb", ",", "n"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "a\[Theta]"}], "]"}], "/", 
              RowBox[{"aScale", "[", "n", "]"}]}]}], "]"}]}]}], "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"P", "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"b\[Theta]", "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "-", "a\[Theta]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z", ",", "U", ",", "UD"}], "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z", ",", "U"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"-", "b\[Theta]"}]}], "&&", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "a\[Theta]"}], ")"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z", ",", "U", ",", "UD"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z", ",", "U"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]D", "[", 
        RowBox[{"n_", ",", "z_", ",", "U_", ",", "UD_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n", ",", "z", ",", "U", ",", "UD"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n", ",", "z", ",", "U", ",", "UD"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "+", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "n"}], "  ", 
                RowBox[{"g", "[", "z", "]"}]}], "-", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{"n", " ", 
         RowBox[{"gD", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{"n", ",", "z", ",", "U"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "+", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}]}], "]"}], "0"},
             {"0", 
              RowBox[{"-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "-", 
                 RowBox[{"n", " ", 
                  RowBox[{"l", "/", "2"}]}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y2D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n", ",", "z", ",", "UCo", ",", "UDCo"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "+", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "n"}], "  ", 
                RowBox[{"g", "[", "z", "]"}]}], "-", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{"n", " ", 
         RowBox[{"gD", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{"n", ",", "z", ",", "UCo"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "+", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}]}], "]"}], "0"},
             {"0", 
              RowBox[{"-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "-", 
                 RowBox[{"n", " ", 
                  RowBox[{"l", "/", "2"}]}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "Y", ",", "YD", ",", "Y2", ",", "Y2D", ",", "U", ",", "funs", ",", 
        "funsd", ",", "UC"}], "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5895407296447153`*^9, 3.589540729969314*^9}, 
   3.589540802591177*^9, {3.589540854311129*^9, 3.589540854919005*^9}, {
   3.589540923324251*^9, 3.589540925780342*^9}, {3.5895409657603407`*^9, 
   3.589540983428316*^9}, {3.589541717801407*^9, 3.589541719634761*^9}, {
   3.589660131043041*^9, 3.589660131412929*^9}, {3.589841146397204*^9, 
   3.589841146773583*^9}, {3.5899986563271027`*^9, 3.58999865946064*^9}, {
   3.5899995837929707`*^9, 3.589999597945817*^9}, {3.59000002397598*^9, 
   3.590000024972547*^9}, {3.590000141949504*^9, 3.590000142105651*^9}, 
   3.590060611414494*^9, {3.590097068394256*^9, 3.590097069040207*^9}, {
   3.590097284790518*^9, 3.590097287726528*^9}, {3.5900974363632298`*^9, 
   3.590097438520356*^9}, {3.5902292446754103`*^9, 3.590229247652383*^9}, {
   3.5902293124499474`*^9, 3.590229312809187*^9}, 3.5903233398492317`*^9, {
   3.5903235648903437`*^9, 3.590323565787298*^9}, {3.590759725262465*^9, 
   3.5907597257255783`*^9}, {3.590762113657524*^9, 3.590762121003368*^9}, {
   3.590762155066615*^9, 3.590762157404413*^9}, {3.5907624551625013`*^9, 
   3.590762478376484*^9}, {3.5907734697492867`*^9, 3.590773482298045*^9}, {
   3.5907779154526043`*^9, 3.590777921677791*^9}, 3.592306559205751*^9, {
   3.592311795346768*^9, 3.5923118574431887`*^9}, {3.592312070758209*^9, 
   3.5923120940847473`*^9}, {3.592399258649925*^9, 3.5923993331050177`*^9}, {
   3.592399591134748*^9, 3.592399602931514*^9}, {3.5923997530776873`*^9, 
   3.592399767144971*^9}, {3.5924758252084627`*^9, 3.5924758454339867`*^9}, {
   3.592475880345063*^9, 3.592475894172887*^9}, {3.592476095206833*^9, 
   3.592476111465736*^9}, {3.592476210478347*^9, 3.592476259841255*^9}, {
   3.592476299083041*^9, 3.592476426698162*^9}, {3.592476543099545*^9, 
   3.592476543709572*^9}, {3.592476634582765*^9, 3.592476700229639*^9}, {
   3.592476755808926*^9, 3.5924767934042683`*^9}, {3.592476866643021*^9, 
   3.592476962914366*^9}, {3.592476993418098*^9, 3.592477030882113*^9}, 
   3.592477128893965*^9, {3.5924773598696136`*^9, 3.59247743273904*^9}, {
   3.592478015721932*^9, 3.592478068629875*^9}, {3.59247811559095*^9, 
   3.59247812419427*^9}, {3.592572178325819*^9, 3.592572178749259*^9}, {
   3.592572234043294*^9, 3.59257223666884*^9}, {3.5925746823685513`*^9, 
   3.592574764249023*^9}, {3.5925748111661873`*^9, 3.592574992148925*^9}, {
   3.592577541791431*^9, 3.592577632633011*^9}, {3.5925776627092667`*^9, 
   3.592577809321559*^9}, {3.5925778504365263`*^9, 3.592577851603881*^9}, {
   3.5925779575375633`*^9, 3.592577958102283*^9}, {3.592578144958789*^9, 
   3.592578149575221*^9}, {3.5925782707588654`*^9, 3.59257831115522*^9}, {
   3.592578443836163*^9, 3.592578566211215*^9}, {3.592578662141841*^9, 
   3.5925786664152613`*^9}, {3.592579309334383*^9, 3.592579311232462*^9}, {
   3.59257967510463*^9, 3.59257969475961*^9}, {3.592579760450506*^9, 
   3.5925798019052*^9}, {3.592580179575375*^9, 3.592580200372979*^9}, {
   3.592580489758765*^9, 3.592580528588295*^9}, {3.592580571874125*^9, 
   3.592580592350278*^9}, {3.592580646164811*^9, 3.592580653503681*^9}, 
   3.5925807214608383`*^9, {3.592581935683482*^9, 3.5925819903569813`*^9}, {
   3.592582120243456*^9, 3.592582121294881*^9}, {3.592591162307914*^9, 
   3.592591192463421*^9}, {3.59275021471873*^9, 3.5927502151719847`*^9}, {
   3.592750288641098*^9, 3.592750308465029*^9}, {3.592750355441546*^9, 
   3.592750789188036*^9}, {3.592750840336198*^9, 3.592750898679747*^9}, {
   3.592750941846402*^9, 3.592750970327241*^9}, {3.592751008073695*^9, 
   3.592751008827567*^9}, {3.5927510449577703`*^9, 3.59275136100445*^9}, {
   3.592772687046978*^9, 3.5927727104419317`*^9}, {3.59277274486236*^9, 
   3.592772751417419*^9}, {3.5927729771203537`*^9, 3.592773048297822*^9}, {
   3.5927734072047243`*^9, 3.592773407578376*^9}, {3.592773595395969*^9, 
   3.592773597112987*^9}, {3.59277500493661*^9, 3.592775005616927*^9}, {
   3.59277553795154*^9, 3.592775555304158*^9}, {3.592775887253866*^9, 
   3.5927759102223454`*^9}, {3.592784043257626*^9, 3.592784043603134*^9}, {
   3.59278425200413*^9, 3.592784258962071*^9}, {3.5927845014465446`*^9, 
   3.592784511711973*^9}, {3.592784614830243*^9, 3.592784620263837*^9}, {
   3.592786681997428*^9, 3.5927867579310293`*^9}, {3.5927875083136873`*^9, 
   3.592787513818997*^9}, {3.59278763524082*^9, 3.5927876386165667`*^9}, {
   3.5928201121724873`*^9, 3.592820160892375*^9}, {3.592820199408033*^9, 
   3.5928201997191887`*^9}, {3.5928203838138447`*^9, 
   3.5928204330184307`*^9}, {3.592820671094553*^9, 3.592820673827636*^9}, {
   3.5928207142445793`*^9, 3.59282071658526*^9}, {3.5928246907564573`*^9, 
   3.5928246986178913`*^9}, {3.592824737772767*^9, 3.5928249000818787`*^9}, {
   3.592824960742051*^9, 3.592825283466778*^9}, {3.592825323904421*^9, 
   3.5928253461156673`*^9}, {3.592829838391728*^9, 3.592829854162137*^9}, {
   3.592913109488846*^9, 3.592913131132509*^9}, {3.5929131789267607`*^9, 
   3.59291318430899*^9}, {3.592913648851315*^9, 3.592913665132141*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Higher order decay", "Section",
 CellChangeTimes->{{3.5345404876667767`*^9, 3.53454048851369*^9}, {
  3.557645004676923*^9, 3.557645007769047*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HOOrthogonalPolynomialMatrixGenerator", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"M_:", "50"}], ",", 
     RowBox[{"L_:", "5."}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "g", ",", "l", ",", "z", ",", "\[Phi]", ",", "supp", ",", "P", ",", 
       "Pin", ",", "rngg", ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", 
       "B", ",", "AP", ",", "BP", ",", "gs", ",", "m", ",", "U", ",", 
       "\[CapitalPsi]", ",", "\[CapitalPhi]", ",", "p", ",", "slvr", ",", "Y",
        ",", "UD", ",", "\[CapitalPsi]D", ",", "\[Phi]D", ",", 
       "\[CapitalPhi]D", ",", "YD", ",", "PD", ",", "BD", ",", "BinD", ",", 
       "rnggR", ",", "\[Alpha]R", ",", "\[Alpha]L", ",", "rsc", ",", "lsc"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"supp", "=", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "=", 
         RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", "z_", "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{"V", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"GFunction", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "V", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
          RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
        RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
        RowBox[{
         RowBox[{"g", "'"}], "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", "z_", "]"}], "=", 
       RowBox[{"Parametrix", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PD", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"ParametrixBranch", "[", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"0", "1"},
            {
             RowBox[{"-", "1"}], "0"}
           }], ")"}], ",", "supp", ",", "z", ",", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", "z_", "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pin", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rngg", "=", 
       RowBox[{"{", 
        RowBox[{".5", ",", "L"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rnggR", "=", 
       RowBox[{"{", 
        RowBox[{".5", ",", 
         RowBox[{"2", " ", "L"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]R", "=", 
       RowBox[{"6", "/", "7"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]L", "=", 
       RowBox[{"2", "/", "3"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rsc", "[", "n_", "]"}], ":=", 
       SuperscriptBox["n", 
        RowBox[{"2", "/", "7"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lsc", "[", "n_", "]"}], ":=", 
       SuperscriptBox["n", 
        RowBox[{"2", "/", "3"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Cdefs", "[", "m_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"n", ",", 
             RowBox[{"(", GridBox[{
                {"a"},
                {
                 RowBox[{"-", 
                  RowBox[{"lsc", "[", "n", "]"}]}]}
               }], ")"}]}], "]"}], ",", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Line", "[", "rngg", "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"\[Alpha]L", " ", "\[Pi]", " ", "I"}], "]"}], 
                 RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "\[Alpha]L"}], " ", "I", " ", "\[Pi]"}], 
                  "]"}], 
                 RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[Alpha]L", " ", "I", " ", "\[Pi]"}], "]"}], " ",
                    ",", "1"}], " ", "}"}], 
                 RowBox[{
                 "rngg", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", " ", ",", 
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{
                    RowBox[{"-", "\[Alpha]L"}], " ", "I", " ", "\[Pi]"}], 
                    "]"}]}], " ", "}"}], 
                 RowBox[{
                 "rngg", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{
                    RowBox[{"-", "\[Alpha]L"}], " ", "I", " ", "\[Pi]"}], 
                    "]"}], " ", ",", 
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{"\[Alpha]L", " ", "I", " ", "\[Pi]"}], "]"}]}], 
                  " ", "}"}], 
                 RowBox[{
                 "rngg", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "m"}
             }], ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"n", ",", 
             RowBox[{"(", GridBox[{
                {"b"},
                {
                 RowBox[{"rsc", "[", "n", "]"}]}
               }], ")"}]}], "]"}], ",", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Line", "[", "rnggR", "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"\[Alpha]R", " ", "\[Pi]", " ", "I"}], "]"}], 
                 RowBox[{"Reverse", "[", "rnggR", "]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "\[Alpha]R"}], " ", "I", " ", "\[Pi]"}], 
                  "]"}], 
                 RowBox[{"Reverse", "[", "rnggR", "]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[Alpha]R", " ", "I", " ", "\[Pi]"}], "]"}], " ",
                    ",", "1"}], " ", "}"}], 
                 RowBox[{
                 "rnggR", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", " ", ",", 
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{
                    RowBox[{"-", "\[Alpha]R"}], " ", "I", " ", "\[Pi]"}], 
                    "]"}]}], " ", "}"}], 
                 RowBox[{
                 "rnggR", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "m"},
              {
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{
                    RowBox[{"-", "\[Alpha]R"}], " ", "I", " ", "\[Pi]"}], 
                    "]"}], " ", ",", 
                   RowBox[{"Exp", "[", " ", 
                    RowBox[{"\[Alpha]R", " ", "I", " ", "\[Pi]"}], "]"}]}], 
                  " ", "}"}], 
                 RowBox[{
                 "rnggR", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "m"}
             }], ")"}]}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], " ", "n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]},
          {"0", "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "1"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P", "[", "z", "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
        RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", 
            RowBox[{"\[Phi]D", "[", "z", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
         }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gs", "[", "n_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{
              RowBox[{"Inverse", "[", 
               RowBox[{
                RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], 
              "&"}]},
            {
             RowBox[{
              RowBox[{"Inverse", "[", 
               RowBox[{
                RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], 
              "&"}]},
            {
             RowBox[{
              RowBox[{"Inverse", "[", 
               RowBox[{
                RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], 
              "&"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"(", GridBox[{
                  {"1", 
                   RowBox[{"-", "1"}]},
                  {"1", "0"}
                 }], ")"}], ".", 
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"Exp", "[", 
                    RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                  {"0", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                 }], ")"}], ".", 
               RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"(", GridBox[{
                  {"1", "0"},
                  {"1", "1"}
                 }], ")"}], ".", 
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"Exp", "[", 
                    RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                  {"0", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                 }], ")"}], ".", 
               RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"(", GridBox[{
                  {"0", 
                   RowBox[{"-", "1"}]},
                  {"1", "0"}
                 }], ")"}], ".", 
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"Exp", "[", 
                    RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
                  {"0", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
                 }], ")"}], ".", 
               RowBox[{"Pin", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}
           }], ")"}], ",", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"AP", "[", "n", "]"}]},
            {
             RowBox[{"BP", "[", "n", "]"}]},
            {
             RowBox[{"BP", "[", "n", "]"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"Exp", "[", 
                    RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                  {"0", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                 }], ")"}], ".", 
               RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"(", GridBox[{
                  {"1", 
                   RowBox[{"-", "1"}]},
                  {"0", "1"}
                 }], ")"}], ".", 
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"Exp", "[", 
                    RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                  {"0", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                 }], ")"}], ".", 
               RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"(", GridBox[{
                  {"0", 
                   RowBox[{"-", "1"}]},
                  {"1", "1"}
                 }], ")"}], ".", 
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"Exp", "[", 
                    RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
                  {"0", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
                 }], ")"}], ".", 
               RowBox[{"Pin", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}
           }], ")"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"slvr", "=", 
       RowBox[{"ScaledRHSolver", "[", 
        RowBox[{"Cdefs", "[", "M", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", "n", "]"}], "=", 
        RowBox[{"slvr", "[", 
         RowBox[{"n", ",", 
          RowBox[{"gs", "[", "n", "]"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"U", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"Dot", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
            RowBox[{"Cauchy", "[", 
             RowBox[{"#", ",", "z"}], "]"}]}], "&"}], "/@", 
          RowBox[{"U", "[", "n", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "\[Alpha]R", " ", "\[Pi]"}], "]"}], " ", 
               ",", "1"}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"\[Alpha]R", " ", "\[Pi]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", " ", 
               RowBox[{"I", " ", "\[Alpha]R", " ", "\[Pi]"}], "]"}], "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], " ", "]"}]}]}], "&&", 
         RowBox[{
          RowBox[{"\[Alpha]R", " ", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{"-", "1"}], "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", " ", 
               RowBox[{"I", " ", "\[Alpha]R", " ", "\[Pi]"}], "]"}], "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "\[Alpha]R"}], " ", "\[Pi]"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", " ", "I"}], " ", "\[Pi]", " ", "\[Alpha]R"}], 
                "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]R"}], " ", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"0", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {"1", "1"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
              "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Exp", "[", 
             RowBox[{"n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
           {"0", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
          }], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"l", "/", "2"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"l", "/", "2"}]}], "]"}]}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"g", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
           RowBox[{"Cauchy", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", "z"}], "]"}]}], ")"}], ".", 
         RowBox[{"CauchyD", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "z"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"CauchyD", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "z"}], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
           RowBox[{"Cauchy", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"U", "[", "n", "]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "z"}], "]"}]}], ")"}]}]}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", " ", 
                RowBox[{"I", " ", "\[Pi]", " ", "\[Alpha]R"}], "]"}], " ", 
               ",", "1"}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{"\[Pi]", " ", "\[Alpha]R"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", " ", 
               RowBox[{"I", " ", "\[Pi]", " ", "\[Alpha]R"}], "]"}], "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"\[Pi]", " ", "\[Alpha]R"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {
              RowBox[{"-", "1"}], "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], ">", 
          RowBox[{"b", "+", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", " ", 
               RowBox[{"I", " ", "\[Pi]", " ", "\[Alpha]R"}], "]"}], "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], " ", "\[Alpha]R"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"RightOfLine", "[", 
          RowBox[{
           RowBox[{"z", "-", "b"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", " ", "I"}], " ", "\[Pi]", " ", "\[Alpha]R"}], 
                "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rnggR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               "/", 
              RowBox[{"rsc", "[", "n", "]"}]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], " ", "\[Alpha]R"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], " ", ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"0", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {"1", "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"LeftOfLine", "[", 
          RowBox[{
           RowBox[{"a", "-", "z"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
              "}"}], 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "z", "]"}], "<", 
          RowBox[{"a", "-", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
             "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", " ", "I", " ", 
                RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
              SuperscriptBox["n", 
               RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
             {"0", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
            }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"UD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"P", "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "3"}]}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", 
          RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "b"}], "]"}], "<", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
          RowBox[{"Arg", "[", 
           RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]D", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"\[CapitalPsi]D", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"YD", "[", 
        RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"YD", "[", 
         RowBox[{"n", ",", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"\[CapitalPhi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{
           RowBox[{"g", "'"}], "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"\[CapitalPhi]", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Y", ",", "YD"}], "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HOOrthogonalPolynomialGenerator", "[", 
   RowBox[{"V_", ",", 
    RowBox[{"M_:", "40"}], ",", 
    RowBox[{"L_:", "5."}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Y", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Y", "=", 
      RowBox[{
       RowBox[{"HOOrthogonalPolynomialMatrixGenerator", "[", 
        RowBox[{"V", ",", "M", ",", "L"}], "]"}], "\[LeftDoubleBracket]", "1",
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"n", ",", "z"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "p"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdx1soQwEAh/GTNEKiaKQmt+1gGaembWgdtydKMh6IYciDmFBOKVJqM2Ep
FmnEchl5VSaKKak9LFKGXGY5eNHQNsn5n4evX19aW29tRxhBECIuaPxUr81n
sXTjcOUxjCvbDHgkLP2S6uJt6h4Q3nI6Nk6T4JpTkAXtvoUC3n2ZCpIV8iJo
YAoFj5wXV8kRkHrQT0Ltk9IEd78cNVEkS1szbS0wbuh2MJpz9SbIa6PqRuDw
bAcvmSfzwGXWfQ8z9kqfYebvnxeq+9yv0HNAR8VwNnvP4uHzYXUCdEq6RJCR
6sXwqCGXgnZHhhzaXNIi+OMzFUOFoaofkrrRIVi+qH+zaFhaOan3Q8oaCECd
KjsI61O9o3cMS5tXheNQel4yA60hvxmq6PUTmDMmdsKehtbG7TGWtlx28hIa
sRZuLYS3Q+1SejeMzE+cgLrQhxFSs81TcFlRNgeFxA7vStp0rJ2TSbnmvVa+
i0gL9/vfvP/pC+gh
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Invariant Ensemble", "Section",
 CellChangeTimes->{{3.554073235564982*^9, 3.5540732368848257`*^9}, {
  3.5774865873328953`*^9, 3.5774865887801933`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvariantEnsembleKernel", "[", 
    RowBox[{"V_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Y", ",", "YD", ",", "K", ",", "eps"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eps", "=", "$MachineEpsilon"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Y", ",", "YD"}], "}"}], "=", 
       RowBox[{"OrthogonalPolynomialMatrixGeneratorConnected", "[", 
        RowBox[{"V", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"K", "[", "n_", "]"}], "[", 
        RowBox[{"x_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n", "]"}], "[", 
         RowBox[{"x", ",", "x"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "\[Pi]", " ", "I"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "n"}], 
           RowBox[{"(", 
            RowBox[{"V", "[", "x", "]"}], ")"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{
             RowBox[{"YD", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", "-", 
           RowBox[{
            RowBox[{
             RowBox[{"YD", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"K", "[", "n_", "]"}], "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n", "]"}], "[", 
         RowBox[{"x", ",", "y"}], "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Yx", ",", "Yy"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Yx", "=", 
            RowBox[{"Y", "[", 
             RowBox[{"n", ",", 
              RowBox[{"x", "+", 
               RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Yy", "=", 
            RowBox[{"Y", "[", 
             RowBox[{"n", ",", 
              RowBox[{"y", "+", 
               RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"2", " ", "\[Pi]", " ", "I"}]]}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "n"}], "/", "2"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"V", "[", "x", "]"}], "+", 
                RowBox[{"V", "[", "y", "]"}]}], ")"}]}], "]"}], 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"Yx", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"Yy", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
              "-", 
              RowBox[{
               RowBox[{"Yy", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"Yx", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
             RowBox[{"x", "-", "y"}]]}]}]}], "\[IndentingNewLine]", "]"}]}]}],
       ";", "\[IndentingNewLine]", "K"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvariantEnsembleKernelAdaptive", "[", 
     RowBox[{"V_", ",", "bool_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Y", ",", "YD", ",", "K", ",", "eps", ",", "out", ",", "YY"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eps", "=", "$MachineEpsilon"}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"OrthogonalPolynomialMatrixGeneratorConnectedAdaptive", "[", 
         RowBox[{"V", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Y", ",", "YD"}], "}"}], "=", 
        RowBox[{"out", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"YY", "=", 
        RowBox[{"out", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n_", "]"}], "[", "\"\<test\>\"", "]"}], ":=", 
        RowBox[{"Show", "[", 
         RowBox[{"DCTPlot", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", "n", "]"}], ")"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n_", "]"}], "[", 
         RowBox[{"x_", ",", "x_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"K", "[", "n", "]"}], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", "\[Pi]", " ", "I"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], 
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], " ", "-", 
            RowBox[{
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], " ", 
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n_", "]"}], "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"K", "[", "n", "]"}], "[", 
          RowBox[{"x", ",", "y"}], "]"}], "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Y1x", ",", "Y2x", ",", "Y1y", ",", "Y2y"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Y1x", "=", 
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Y2x", "=", 
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Y1y", "=", 
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"y", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Y2y", "=", 
             RowBox[{
              RowBox[{"YY", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"n", ",", 
               RowBox[{"y", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", 
               RowBox[{"2", " ", "\[Pi]", " ", "I"}]]}], 
             FractionBox[
              RowBox[{
               RowBox[{"Y1x", " ", "Y2y"}], "-", 
               RowBox[{"Y1y", " ", "Y2x"}]}], 
              RowBox[{"x", "-", "y"}]]}]}]}], "\[IndentingNewLine]", 
          "]"}]}]}], ";", "\[IndentingNewLine]", "K"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HOInvariantEnsembleKernel", "[", 
     RowBox[{"V_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Y", ",", "YD", ",", "K", ",", "eps"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eps", "=", "$MachineEpsilon"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Y", ",", "YD"}], "}"}], "=", 
        RowBox[{"HOOrthogonalPolynomialMatrixGenerator", "[", 
         RowBox[{"V", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n_", "]"}], "[", 
         RowBox[{"x_", ",", "x_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"K", "[", "n", "]"}], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", "\[Pi]", " ", "I"}]], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "n"}], 
            RowBox[{"(", 
             RowBox[{"V", "[", "x", "]"}], ")"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Y", "[", 
               RowBox[{"n", ",", 
                RowBox[{"x", "+", 
                 RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"YD", "[", 
               RowBox[{"n", ",", 
                RowBox[{"x", "+", 
                 RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", "-", 
            
            RowBox[{
             RowBox[{
              RowBox[{"YD", "[", 
               RowBox[{"n", ",", 
                RowBox[{"x", "+", 
                 RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{
              RowBox[{"Y", "[", 
               RowBox[{"n", ",", 
                RowBox[{"x", "+", 
                 RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n_", "]"}], "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"K", "[", "n", "]"}], "[", 
          RowBox[{"x", ",", "y"}], "]"}], "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Yx", ",", "Yy"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Yx", "=", 
             RowBox[{"Y", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Yy", "=", 
             RowBox[{"Y", "[", 
              RowBox[{"n", ",", 
               RowBox[{"y", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", 
               RowBox[{"2", " ", "\[Pi]", " ", "I"}]]}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "n"}], "/", "2"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"V", "[", "x", "]"}], "+", 
                 RowBox[{"V", "[", "y", "]"}]}], ")"}]}], "]"}], 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"Yx", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                RowBox[{"Yy", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
               "-", 
               RowBox[{
                RowBox[{"Yy", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                RowBox[{"Yx", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
              RowBox[{"x", "-", "y"}]]}]}]}], "\[IndentingNewLine]", 
          "]"}]}]}], ";", "\[IndentingNewLine]", "K"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracyWidomEdgeScalingConstant", "[", "\[Mu]_SingFun", "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RightEndpoint", "[", "\[Mu]", "]"}], "-", 
       RowBox[{"LeftEndpoint", "[", "\[Mu]", "]"}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "3"}]], " ", 
    SuperscriptBox[
     RowBox[{"MapDot", "[", 
      RowBox[{
       RowBox[{"#", "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "\[Pi]", "\[NonBreakingSpace]", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//",
          "DCT"}], "//", "ToChebyshevUSeries"}]}], "]"}], 
     RowBox[{"2", "/", "3"}]]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.554073237723023*^9, 3.5540733247755527`*^9}, {
   3.554073396724359*^9, 3.554073397538052*^9}, {3.5540734566832314`*^9, 
   3.554073458633712*^9}, {3.554078597900989*^9, 3.554078599483601*^9}, {
   3.5540807380182467`*^9, 3.5540807383701887`*^9}, {3.554081820107893*^9, 
   3.554081838554685*^9}, {3.557835744788105*^9, 3.5578357536049623`*^9}, {
   3.5775645696420183`*^9, 3.577564569963211*^9}, {3.577566647281152*^9, 
   3.57756665817365*^9}, {3.577566693396606*^9, 3.57756675091654*^9}, {
   3.5775673469730663`*^9, 3.577567356795206*^9}, {3.592332265023394*^9, 
   3.592332270243431*^9}, {3.592332391334835*^9, 3.592332398192235*^9}, 
   3.59233250959536*^9, {3.5929137845476*^9, 3.592913784930451*^9}, {
   3.598473450135921*^9, 3.598473463781836*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["From EM", "Section",
 CellChangeTimes->{{3.5193709710781612`*^9, 3.51937097231778*^9}, {
  3.577486607457485*^9, 3.5774866082630787`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EMOrthogonalPolynomialMatrixGeneratorConnected", "[", 
     RowBox[{"\[Mu]_SingFun", ",", 
      RowBox[{"M_:", "40"}], ",", 
      RowBox[{"L_:", "3."}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "supp", ",", "g", ",", "l", ",", "z", ",", "\[Phi]", ",", "P", ",", 
        "Pin", ",", "rngg", ",", "Cdefs", ",", "a", ",", "b", ",", "A", ",", 
        "B", ",", "AP", ",", "BP", ",", "gs", ",", "m", ",", "U", ",", 
        "\[CapitalPsi]", ",", "\[CapitalPhi]", ",", "p", ",", "slvr", ",", 
        "Y", ",", "UD", ",", "\[CapitalPsi]D", ",", "\[Phi]D", ",", 
        "\[CapitalPhi]D", ",", "YD", ",", "PD", ",", "BD", ",", "BinD", ",", 
        "V"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"supp", "=", 
        RowBox[{"\[Mu]", "//", "Domain"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "=", 
        RowBox[{"supp", "//", "First"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"2", "\[Pi]"}], ")"}]}], "\[Mu]"}], "//", "Hilbert"}], 
           "//", "First"}], "//", "Integrate"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"V", "-", 
         RowBox[{"V", "[", "0.", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", "z_", "]"}], "=", 
        RowBox[{"CauchyInverseIntegral", "[", 
         RowBox[{
          RowBox[{"V", "'"}], ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"CauchyInverseIntegralS", "[", 
         RowBox[{
          RowBox[{"+", "1"}], ",", 
          RowBox[{"V", "'"}], ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"CauchyInverseIntegralS", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"V", "'"}], ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"+", "1"}], ",", "0."}], "]"}], "+", 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0."}], "]"}], "-", 
           RowBox[{"V", "[", "0.", "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "z_", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}], "-", 
         
         RowBox[{"g", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]D", "[", "z_", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", "'"}], "[", "z", "]"}], ")"}], "/", "2"}], "-", 
         RowBox[{
          RowBox[{"g", "'"}], "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"+", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"+", "1"}], ",", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"V", "[", "z", "]"}], "-", "l"}], ")"}], "/", "2"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", "z_", "]"}], "=", 
        RowBox[{"Parametrix", "[", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {"0", "1"},
             {
              RowBox[{"-", "1"}], "0"}
            }], ")"}], ",", "supp", ",", "z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PD", "[", "z_", "]"}], "=", 
        RowBox[{
         RowBox[{"P", "'"}], "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"ParametrixBranch", "[", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {"0", "1"},
             {
              RowBox[{"-", "1"}], "0"}
            }], ")"}], ",", "supp", ",", "z", ",", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[Pi]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pin", "[", "z_", "]"}], "=", 
        RowBox[{"Inverse", "[", 
         RowBox[{"P", "[", "z", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pin", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "z_"}], "]"}], "=", 
        RowBox[{"Inverse", "[", 
         RowBox[{"P", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "z"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rngg", "=", 
        RowBox[{"{", 
         RowBox[{".5", ",", "L"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cdefs", "[", "m_", "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"n", ",", 
            RowBox[{"(", GridBox[{
               {"b", "a"},
               {
                SuperscriptBox["n", 
                 RowBox[{"2", "/", "3"}]], 
                RowBox[{"-", 
                 SuperscriptBox["n", 
                  RowBox[{"2", "/", "3"}]]}]}
              }], ")"}]}], "]"}], ",", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Line", "[", "rngg", "]"}], "m"},
             {
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "\[Pi]", " ", 
                  RowBox[{"I", "/", "3"}]}], "]"}], 
                RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
             {
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], 
                RowBox[{"Reverse", "[", "rngg", "]"}]}], "]"}], "m"},
             {
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"2", " ", "I", " ", 
                    RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], 
                 " ", "}"}], 
                RowBox[{
                "rngg", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], "m"},
             {
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", " ", ",", 
                  RowBox[{"Exp", "[", " ", 
                   RowBox[{
                    RowBox[{"-", "2"}], " ", "I", " ", 
                    RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
                RowBox[{
                "rngg", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], "m"},
             {
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Exp", "[", " ", 
                   RowBox[{
                    RowBox[{"-", "2"}], " ", "I", " ", 
                    RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", 
                  RowBox[{"Exp", "[", " ", 
                   RowBox[{
                    RowBox[{"-", "4"}], " ", "I", " ", 
                    RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
                RowBox[{
                "rngg", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], "m"}
            }], ")"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"1", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]},
           {"0", "1"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"B", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "1"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"AP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"P", "[", "z", "]"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "n", "]"}], "[", "z", "]"}], ".", 
         RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BP", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"P", "[", "z", "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], ".", 
         RowBox[{"Pin", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"0", "0"},
           {
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"\[Phi]D", "[", "z", "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BinD", "[", "n_", "]"}], "[", "z_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {"0", "0"},
           {
            RowBox[{
             RowBox[{"-", "2"}], " ", "n", " ", 
             RowBox[{"\[Phi]D", "[", "z", "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"}
          }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gs", "[", "n_", "]"}], ":=", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"AP", "[", "n", "]"}], 
            RowBox[{
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"AP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
           {
            RowBox[{"BP", "[", "n", "]"}], 
            RowBox[{
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
           {
            RowBox[{"BP", "[", "n", "]"}], 
            RowBox[{
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"BP", "[", "n", "]"}], "[", "#", "]"}], "]"}], "&"}]},
           {
            RowBox[{
             RowBox[{
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"Exp", "[", 
                   RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                 {"0", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                }], ")"}], ".", 
              RowBox[{"Pin", "[", "#", "]"}]}], "&"}], 
            RowBox[{
             RowBox[{
              RowBox[{"(", GridBox[{
                 {"1", 
                  RowBox[{"-", "1"}]},
                 {"1", "0"}
                }], ")"}], ".", 
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"Exp", "[", 
                   RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                 {"0", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                }], ")"}], ".", 
              RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
           {
            RowBox[{
             RowBox[{
              RowBox[{"(", GridBox[{
                 {"1", 
                  RowBox[{"-", "1"}]},
                 {"0", "1"}
                }], ")"}], ".", 
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"Exp", "[", 
                   RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                 {"0", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                }], ")"}], ".", 
              RowBox[{"Pin", "[", "#", "]"}]}], "&"}], 
            RowBox[{
             RowBox[{
              RowBox[{"(", GridBox[{
                 {"1", "0"},
                 {"1", "1"}
                }], ")"}], ".", 
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"Exp", "[", 
                   RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "0"},
                 {"0", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}]}
                }], ")"}], ".", 
              RowBox[{"Pin", "[", "#", "]"}]}], "&"}]},
           {
            RowBox[{
             RowBox[{
              RowBox[{"(", GridBox[{
                 {"0", 
                  RowBox[{"-", "1"}]},
                 {"1", "1"}
                }], ")"}], ".", 
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"Exp", "[", 
                   RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
                 {"0", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
                }], ")"}], ".", 
              RowBox[{"Pin", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}], 
            RowBox[{
             RowBox[{
              RowBox[{"(", GridBox[{
                 {"0", 
                  RowBox[{"-", "1"}]},
                 {"1", "0"}
                }], ")"}], ".", 
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"Exp", "[", 
                   RowBox[{"n", " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}], "0"},
                 {"0", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "n"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "]"}]}
                }], ")"}], ".", 
              RowBox[{"Pin", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "#"}], "]"}]}], "&"}]}
          }], ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"U", "[", "n_", "]"}], ":=", 
        RowBox[{
         RowBox[{"U", "[", "n", "]"}], "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstructCurve", "[", 
             RowBox[{
              RowBox[{"Cdefs", "[", "M", "]"}], ",", 
              RowBox[{"gs", "[", "n", "]"}], ",", "n"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Fun", "[", 
               RowBox[{
                RowBox[{"BP", "[", "n", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"a", "+", 
                    RowBox[{
                    RowBox[{"Exp", "[", " ", 
                    RowBox[{"\[Pi]", " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                    RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}], ",", 
                   RowBox[{"b", "+", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"2", " ", "\[Pi]", " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                    RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}]}], "}"}], "]"}], ",", 
                RowBox[{"M", "+", "20"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Fun", "[", 
               RowBox[{
                RowBox[{"BP", "[", "n", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"a", "+", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", " ", "\[Pi]"}], " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                    RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}], ",", 
                   RowBox[{"b", "+", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
                    RowBox[{"I", "/", "3"}]}], "]"}], " ", 
                    RowBox[{"L", "/", 
                    SuperscriptBox["n", 
                    RowBox[{"2", "/", "3"}]]}]}]}]}], "}"}], "]"}], ",", 
                RowBox[{"M", "+", "20"}]}], "]"}]}], "\[IndentingNewLine]", 
             "}"}]}], "]"}], "//", "RHSolve"}]}]}], ";", "\n", 
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
          RowBox[{"Cauchy", "[", 
           RowBox[{
            RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
               "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], "&&", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {
             RowBox[{"-", "1"}], "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Pi]", "/", "3"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"0", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
          
          RowBox[{
           RowBox[{"\[Pi]", "/", "3"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"1", "1"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
               "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"1", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"(", GridBox[{
            {"0", 
             RowBox[{"-", "1"}]},
            {"1", "0"}
           }], ")"}], ".", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"Exp", "[", 
              RowBox[{"n", " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
            {"0", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "n"}], " ", 
               RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
           }], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"P", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"\[Pi]", "/", "3"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{
          RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
          RowBox[{
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"n", ",", "z"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Y", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"l", "/", "2"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"l", "/", "2"}]}], "]"}]}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"g", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UD", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"CauchyD", "[", 
         RowBox[{
          RowBox[{"U", "[", "n", "]"}], ",", "z"}], "]"}]}], ";", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
               "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", "/", "3"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {
              RowBox[{"-", "1"}], "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", "0"},
              {
               RowBox[{"-", "1"}], "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], ">", 
           RowBox[{"b", "+", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Pi]", "/", "3"}]}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "1"}
             }], ")"}], " ", ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"RightOfLine", "[", 
           RowBox[{
            RowBox[{"z", "-", "b"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Pi]", "/", "3"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"0", "1"}
            }], ")"}], " ", ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"0", "1"}
             }], ")"}], " ", ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", " ", 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], " ", "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", " ", 
          
          RowBox[{
           RowBox[{"\[Pi]", "/", "3"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "\[LessEqual]", "\[Pi]"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", "0"},
             {"1", "1"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", "0"},
              {"1", "1"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"LeftOfLine", "[", 
           RowBox[{
            RowBox[{"a", "-", "z"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "I", " ", 
                  RowBox[{"\[Pi]", "/", "3"}]}], "]"}], " ", ",", "1"}], " ", 
               "}"}], 
              RowBox[{
               RowBox[{
               "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], "]"}]}], "]"}], " ", "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "3"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"1", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"1", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPsi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "z", "]"}], "<", 
           RowBox[{"a", "-", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{
              "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"2", " ", "I", " ", 
                 RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "/", 
               SuperscriptBox["n", 
                RowBox[{"2", "/", "3"}]]}]}], " ", "]"}]}]}], " ", "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"(", GridBox[{
             {"0", 
              RowBox[{"-", "1"}]},
             {"1", "0"}
            }], ")"}], ".", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"Exp", "[", 
               RowBox[{"n", " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}], "0"},
             {"0", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}
            }], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]D", "[", "z", "]"}], " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {"0", 
               RowBox[{"-", "1"}]},
              {"1", "0"}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"n", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}], "0"},
              {"0", 
               RowBox[{
                RowBox[{"-", "n"}], " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"\[Phi]", "[", "z", "]"}]}], "]"}]}]}
             }], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"UD", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"P", "[", "z", "]"}]}], "+", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"PD", "[", "z", "]"}]}]}]}], ";", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"\[Pi]", "/", "3"}]}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}]}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", 
           RowBox[{"\[Pi]", "/", "3"}]}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{
           RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{
           RowBox[{"BD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]D", "[", 
          RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Im", "[", "z", "]"}], "<", "0"}], "&&", 
          RowBox[{
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "b"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Pi]", "/", "3"}]}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "3"}], "<", 
           RowBox[{"Arg", "[", 
            RowBox[{"z", "-", "a"}], "]"}], "<", "0"}]}]}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]D", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"B", "[", "n", "]"}], "[", "z", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", 
           RowBox[{"n", ",", "z"}], "]"}], ".", 
          RowBox[{
           RowBox[{"BinD", "[", "n", "]"}], "[", "z", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPhi]D", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{"\[CapitalPsi]D", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], ";", "\n", 
       RowBox[{
        RowBox[{"YD", "[", 
         RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"YD", "[", 
          RowBox[{"n", ",", "z"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"\[CapitalPhi]D", "[", 
            RowBox[{"n", ",", "z"}], "]"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"l", "/", "2"}]}], "]"}]}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Exp", "[", 
                RowBox[{"n", " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
              {"0", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "n"}], " ", 
                 RowBox[{"g", "[", "z", "]"}]}], "]"}]}
             }], ")"}]}], "+", 
          RowBox[{"n", " ", 
           RowBox[{
            RowBox[{"g", "'"}], "[", "z", "]"}], " ", 
           RowBox[{
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "z"}], "]"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"l", "/", "2"}]}], "]"}]}
              }], ")"}], ".", 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Exp", "[", 
                 RowBox[{"n", " ", 
                  RowBox[{"g", "[", "z", "]"}]}], "]"}], "0"},
               {"0", 
                RowBox[{"-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "n"}], " ", 
                   RowBox[{"g", "[", "z", "]"}]}], "]"}]}]}
              }], ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Y", ",", "YD"}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EMInvariantEnsembleKernel", "[", 
    RowBox[{"\[Mu]_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Y", ",", "YD", ",", "K", ",", "eps", ",", "V"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eps", "=", "$MachineEpsilon"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Y", ",", "YD"}], "}"}], "=", 
       RowBox[{"EMOrthogonalPolynomialMatrixGeneratorConnected", "[", 
        RowBox[{"\[Mu]", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"2", "\[Pi]"}], ")"}]}], "\[Mu]"}], "//", "Hilbert"}], "//",
           "First"}], "//", "Integrate"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"V", "-", 
        RowBox[{"V", "[", "0.", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"K", "[", "n_", "]"}], "[", 
        RowBox[{"x_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n", "]"}], "[", 
         RowBox[{"x", ",", "x"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "\[Pi]", " ", "I"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "n"}], 
           RowBox[{"(", 
            RowBox[{"V", "[", "x", "]"}], ")"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{
             RowBox[{"YD", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", "-", 
           RowBox[{
            RowBox[{
             RowBox[{"YD", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"n", ",", 
               RowBox[{"x", "+", 
                RowBox[{"eps", " ", "I"}]}]}], "]"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"K", "[", "n_", "]"}], "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", "n", "]"}], "[", 
         RowBox[{"x", ",", "y"}], "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Yx", ",", "Yy"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Yx", "=", 
            RowBox[{"Y", "[", 
             RowBox[{"n", ",", 
              RowBox[{"x", "+", 
               RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Yy", "=", 
            RowBox[{"Y", "[", 
             RowBox[{"n", ",", 
              RowBox[{"y", "+", 
               RowBox[{"eps", " ", "I"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"2", " ", "\[Pi]", " ", "I"}]]}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "n"}], "/", "2"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"V", "[", "x", "]"}], "+", 
                RowBox[{"V", "[", "y", "]"}]}], ")"}]}], "]"}], 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"Yx", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"Yy", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
              "-", 
              RowBox[{
               RowBox[{"Yy", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"Yx", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
             RowBox[{"x", "-", "y"}]]}]}]}], "\[IndentingNewLine]", "]"}]}]}],
       ";", "\[IndentingNewLine]", "K"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.509370145998357*^9, 3.509370378202314*^9}, {
   3.5105607172894363`*^9, 3.510560718472644*^9}, {3.5105609556378613`*^9, 
   3.510560966176848*^9}, {3.510561064211748*^9, 3.5105611647782803`*^9}, {
   3.510561233491415*^9, 3.510561241664692*^9}, {3.510571057702458*^9, 
   3.5105710648074703`*^9}, {3.5105721235587397`*^9, 
   3.5105721298090057`*^9}, {3.51065357393624*^9, 3.510653693191971*^9}, {
   3.510655918920662*^9, 3.5106559198393106`*^9}, {3.5106559786311827`*^9, 
   3.510655979174008*^9}, {3.5106567374743843`*^9, 3.51065676662239*^9}, {
   3.510656802084001*^9, 3.510656815968279*^9}, {3.510656846607452*^9, 
   3.510657106054304*^9}, {3.510657166246749*^9, 3.510657186429552*^9}, {
   3.510657267223605*^9, 3.5106573315366793`*^9}, {3.5106574253544617`*^9, 
   3.5106574491169033`*^9}, {3.5106574974003477`*^9, 3.510657508403316*^9}, {
   3.5106579383917503`*^9, 3.510657972012226*^9}, {3.5193718159736443`*^9, 
   3.519371867285171*^9}, {3.519371903930711*^9, 3.519371905121751*^9}, {
   3.554078604495112*^9, 3.5540786050620413`*^9}, 3.554079969825622*^9, {
   3.554081608784966*^9, 3.55408161211854*^9}, {3.554081650065937*^9, 
   3.5540816507992067`*^9}, {3.554081770758059*^9, 3.5540817710766*^9}, {
   3.577486613196619*^9, 3.5774866311793413`*^9}, {3.577486707902728*^9, 
   3.5774868080611477`*^9}, {3.577487089986491*^9, 3.577487118796727*^9}, {
   3.577487175311667*^9, 3.577487175457345*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Finish", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{800, 824},
WindowMargins->{{-6, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 24, 0, 80, "Section"],
Cell[606, 24, 285, 8, 46, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[928, 37, 32, 0, 80, "Section"],
Cell[963, 39, 2005, 33, 267, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3005, 77, 94, 1, 80, "Section"],
Cell[3102, 80, 3759, 106, 334, "Input",
 InitializationCell->True],
Cell[6864, 188, 59217, 1673, 3532, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[66118, 1866, 95, 1, 50, "Section"],
Cell[66216, 1869, 58502, 1678, 3496, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[124755, 3552, 255, 3, 50, "Section"],
Cell[125013, 3557, 27398, 563, 998, "Input",
 InitializationCell->True],
Cell[152414, 4122, 254303, 6847, 13605, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[406754, 10974, 153, 2, 50, "Section"],
Cell[406910, 10978, 62520, 1747, 2708, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[469467, 12730, 158, 2, 50, "Section"],
Cell[469628, 12734, 15976, 412, 1174, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[485641, 13151, 144, 2, 80, "Section"],
Cell[485788, 13155, 67681, 1833, 2733, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[553506, 14993, 25, 0, 50, "Section"],
Cell[553534, 14995, 175, 5, 46, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
