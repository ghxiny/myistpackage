(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     24403,        685]
NotebookOptionsPosition[     23247,        639]
NotebookOutlinePosition[     23638,        656]
CellTagsIndexPosition[     23595,        653]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell["\<\
\[Copyright] Sheehan Olver, 2010, subject to BSD license.

Other contributors include Georg Wechslberger.

FredholmDet is based on code by Folkmar Bornemann.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Setup", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<RiemannHilbert`RandomMatrices`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<RiemannHilbert`\>\"", ",", "\"\<RiemannHilbert`Common`\>\""}], 
     "}"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Documentation", "Section"],

Cell[BoxData[{
 RowBox[{"PlotEquilibriumMeasure", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasureSupport", "::", "usage"}], "=", 
   "\"\<EquilibriumMeasureSupport[V] Computes the support of the equilibrium \
measure (currently only for convex V\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasure", "::", "usage"}], "=", 
   "\"\<EquilibriumMeasure[V,x] Computes the equilibrium measure at a point x \
inside the support\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EquilibriumMeasureNewton", ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasureSupport", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"retin_", "?", "VectorQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ret", ",", "retold", ",", "F", ",", "J", ",", "k"}], "}"}], 
     ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "Vf", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Vf", "=", 
           RowBox[{"Fun", "[", 
            RowBox[{"V", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DCT", "[", 
              RowBox[{"Vf", "'"}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"b", "-", "a"}], "8"], 
              RowBox[{
               RowBox[{"DCT", "[", 
                RowBox[{"Vf", "'"}], "]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "-", "1"}]}], "}"}]}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"J", "[", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Vf", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Vf", "=", 
           RowBox[{"Fun", "[", 
            RowBox[{"V", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x", "=", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{"Points", "[", 
              RowBox[{"UnitInterval", ",", 
               RowBox[{"Length", "[", "Vf", "]"}]}], "]"}], ",", 
             RowBox[{"Vf", "//", "Domain"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(", GridBox[{
             {
              RowBox[{
               RowBox[{"DCT", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "2"], "-", 
                   FractionBox["x", "2"]}], ")"}], 
                 RowBox[{"Vf", "''"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], 
              RowBox[{
               RowBox[{"DCT", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "2"], "+", 
                   FractionBox["x", "2"]}], ")"}], 
                 RowBox[{"Vf", "''"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]},
             {
              RowBox[{
               FractionBox["1", "8"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"b", "-", "a"}], ")"}], 
                  RowBox[{
                   RowBox[{"DCT", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "2"], "-", 
                    FractionBox["x", "2"]}], ")"}], 
                    RowBox[{"Vf", "''"}]}], "]"}], "\[LeftDoubleBracket]", 
                   "2", "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{
                  RowBox[{"DCT", "[", 
                   RowBox[{"Vf", "'"}], "]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], 
              RowBox[{
               FractionBox["1", "8"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"b", "-", "a"}], ")"}], 
                  RowBox[{
                   RowBox[{"DCT", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "2"], "+", 
                    FractionBox["x", "2"]}], ")"}], 
                    RowBox[{"Vf", "''"}]}], "]"}], "\[LeftDoubleBracket]", 
                   "2", "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{
                  RowBox[{"DCT", "[", 
                   RowBox[{"Vf", "'"}], "]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}
            }], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", "retin"}], ";", "\[IndentingNewLine]", 
      RowBox[{"retold", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"ret", "-", "retold"}], "]"}], ">", "$MachineTolerance"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k", "=", 
          RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"retold", "=", "ret"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ret", "=", 
          RowBox[{"ret", "-", 
           RowBox[{"LeastSquares", "[", 
            RowBox[{
             RowBox[{"J", "[", "ret", "]"}], ",", 
             RowBox[{"F", "[", "ret", "]"}]}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "k", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "//", "Sort"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasure", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"retin_", "?", "VectorQ"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"EquilibriumMeasure", "[", 
     RowBox[{"V", ",", "retin"}], "]"}], "[", "x", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasure", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"retin_", "?", "VectorQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "\[Pi]"}], ")"}]}], " ", 
     RowBox[{"SingFun", "[", 
      RowBox[{
       RowBox[{"Fun", "[", 
        RowBox[{
         RowBox[{"V", "'"}], ",", 
         RowBox[{
          RowBox[{"EquilibriumMeasureSupport", "[", 
           RowBox[{"V", ",", "retin"}], "]"}], "//", "Line"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "//", "HilbertInverse"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotEquilibriumMeasure", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"supp", ",", "x", ",", "\[Psi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"supp", "=", 
       RowBox[{"EquilibriumMeasureSupport", "[", "V", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "x_", "]"}], "=", 
       RowBox[{"EquilibriumMeasure", "[", 
        RowBox[{"V", ",", "supp", ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"\[Psi]", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
          "supp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "supp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], ",", "opts"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591896720871264*^9, 3.59189675297696*^9}, {
  3.591896794077495*^9, 3.591896795294077*^9}, {3.59189695354743*^9, 
  3.591896954821198*^9}, {3.593395693897853*^9, 3.593395695085349*^9}, {
  3.593396068007331*^9, 3.5933960741121693`*^9}, {3.593396237377212*^9, 
  3.593396238427327*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiple intervals", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasureNewton", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"lin_", "?", "MatrixQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"FJ", ",", "x", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FJ", "[", 
        RowBox[{"fl_", ",", "ci_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "HD", ",", "FD", ",", "a", ",", "b", ",", "i", ",", "j", ",", "spc",
            ",", "ciD", ",", "H"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "[", "j_", "]"}], ":=", 
           RowBox[{"RightEndpoint", "[", 
            RowBox[{
            "fl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "[", "j_", "]"}], ":=", 
           RowBox[{"LeftEndpoint", "[", 
            RowBox[{
            "fl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ciD", "[", "spc__", "]"}], ":=", 
           RowBox[{
            RowBox[{"ciD", "[", "spc", "]"}], "=", 
            RowBox[{
             RowBox[{"CauchyInverseCurvesOptimalD", "[", "spc", "]"}], "[", 
             "fl", "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"H", "[", "i_", "]"}], ":=", 
           RowBox[{
            RowBox[{"CauchyInverseIntegralPlusSum", "[", 
             RowBox[{"ci", ",", 
              RowBox[{"b", "[", "i", "]"}]}], "]"}], "-", 
            RowBox[{"V", "[", 
             RowBox[{"b", "[", "i", "]"}], "]"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"CauchyInverseIntegralPlusSum", "[", 
               RowBox[{"ci", ",", 
                RowBox[{"a", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "]"}], "-", 
              RowBox[{"V", "[", 
               RowBox[{"a", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"HD", "[", "spc__", "]"}], "[", "i_", "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"CauchyInverseIntegralPlusEndpointD", "[", "spc", "]"}], 
             "[", 
             RowBox[{"fl", ",", 
              RowBox[{"2", " ", "i"}], ",", "ci", ",", 
              RowBox[{"ciD", "[", "spc", "]"}]}], "]"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"CauchyInverseIntegralPlusEndpointD", "[", "spc", "]"}],
               "[", 
              RowBox[{"fl", ",", 
               RowBox[{
                RowBox[{"2", " ", "i"}], "+", "1"}], ",", "ci", ",", 
               RowBox[{"ciD", "[", "spc", "]"}]}], "]"}], ")"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "spc", "}"}], "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"-", 
               RowBox[{
                RowBox[{"V", "'"}], "[", 
                RowBox[{"b", "[", "i", "]"}], "]"}]}], ",", "0"}], "]"}], "-", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "spc", "}"}], "\[LeftDoubleBracket]", 
                RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], 
               "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"-", 
               RowBox[{
                RowBox[{"V", "'"}], "[", 
                RowBox[{"a", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", "0"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FD", "[", "spc__", "]"}], ":=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Mean", "/@", 
              RowBox[{"ciD", "[", "spc", "]"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"{", 
              RowBox[{
               RowBox[{"CauchyInverseSeriesAtInfinityD", "[", "spc", "]"}], 
               "[", 
               RowBox[{"fl", ",", "ci", ",", 
                RowBox[{"ciD", "[", "spc", "]"}]}], "]"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"HD", "[", "spc", "]"}], "[", "j", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "fl", "]"}], "-", "1"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Mean", "/@", "ci"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CauchyInverseSeriesAtInfinitySum", "[", "ci", "]"}], 
                "-", "1"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Array", "[", 
               RowBox[{"H", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "fl", "]"}], "-", "1"}]}], "]"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"FD", "@@", 
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", "2"}], "]"}]}], ")"}], "&"}], "/@", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", " ", 
                RowBox[{"Length", "[", "fl", "]"}]}], "]"}]}], "//", 
             "Transpose"}]}], "\[IndentingNewLine]", "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "0", "]"}], "=", "lin"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"x", "[", "n", "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"fl", ",", "ci", ",", "F", ",", "J"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fl", "=", 
            RowBox[{"Fun", "[", 
             RowBox[{
              RowBox[{"V", "'"}], ",", 
              RowBox[{"Line", "/@", 
               RowBox[{"x", "[", 
                RowBox[{"n", "-", "1"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ci", "=", 
            RowBox[{"fl", "//", "CauchyInverseCurvesOptimal"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"F", ",", "J"}], "}"}], "=", 
            RowBox[{"FJ", "[", 
             RowBox[{"fl", ",", "ci"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"n", "-", "1"}], "]"}], "-", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Inverse", "[", "J", "]"}], ".", "F"}], ",", "2"}], 
              "]"}]}], "//", "Re"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "x"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasureSupport", "[", 
    RowBox[{"V_", ",", 
     RowBox[{"retin_", "?", "MatrixQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"EquilibriumMeasureNewton", "[", 
        RowBox[{"V", ",", "retin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"x", "[", "k", "]"}], "-", 
           RowBox[{"x", "[", 
            RowBox[{"k", "+", "1"}], "]"}]}], "]"}], ">", 
         "$MachineTolerance"}], ",", 
        RowBox[{
         RowBox[{"k", "++"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "[", "k", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquilibriumMeasure", "[", 
   RowBox[{"V_", ",", 
    RowBox[{"retin_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xn", ",", "fl", ",", "ci"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"xn", "=", 
      RowBox[{"EquilibriumMeasureSupport", "[", 
       RowBox[{"V", ",", "retin"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fl", "=", 
      RowBox[{"Fun", "[", 
       RowBox[{
        RowBox[{"V", "'"}], ",", 
        RowBox[{"Line", "/@", "xn"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ci", "=", 
      RowBox[{"fl", "//", "CauchyInverseCurvesOptimal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "\[Pi]"}], ")"}]}], 
        RowBox[{"HilbertInverse", "[", 
         RowBox[{"SingFun", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}], "&"}], "/@", 
      "ci"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59189658437649*^9, 3.591896605475442*^9}, {
   3.591896665223662*^9, 3.591896665659124*^9}, {3.5933882236299343`*^9, 
   3.593388250337523*^9}, {3.593395282123426*^9, 3.59339530685538*^9}, {
   3.593395378116296*^9, 3.59339541481468*^9}, 3.59339622834839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outer Routine", "Section",
 CellChangeTimes->{{3.593395704391059*^9, 3.593395708813876*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EquilibriumMeasure", "[", "V_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"em", ",", "roots", ",", "lin"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"em", "=", 
       RowBox[{"EquilibriumMeasure", "[", 
        RowBox[{"V", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"roots", "=", 
       RowBox[{
        RowBox[{"em", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "//", "Roots"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"roots", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "em", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lin", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"em", "//", "First"}], "//", "Domain"}], "//", 
                "First"}], ",", "\[IndentingNewLine]", "roots"}], "]"}], "//",
              "Sort"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"EquilibriumMeasure", "[", 
          RowBox[{"V", ",", "lin"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquilibriumMeasureSupport", "[", "V_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"V", "//", "EquilibriumMeasure"}], "//", "Domain"}], "//", 
   "First"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.593395714384606*^9, 3.593395725023662*^9}, {
  3.593395758367634*^9, 3.593395759566533*^9}, {3.59339579620682*^9, 
  3.593395884596056*^9}, {3.593395920761961*^9, 3.593395953807886*^9}, {
  3.593396248720324*^9, 3.593396264206664*^9}, {3.5984731765456457`*^9, 
  3.598473177340222*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1188, 1342},
WindowMargins->{{201, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 184, 4, 28, "Input"],
Cell[744, 26, 181, 6, 106, "Text"],
Cell[CellGroupData[{
Cell[950, 36, 24, 0, 80, "Section"],
Cell[977, 38, 285, 8, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1299, 51, 32, 0, 80, "Section"],
Cell[1334, 53, 616, 13, 97, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1987, 71, 28, 0, 80, "Section"],
Cell[2018, 73, 8384, 223, 591, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10439, 301, 37, 0, 80, "Section"],
Cell[10479, 303, 10283, 260, 743, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20799, 568, 98, 1, 80, "Section"],
Cell[20900, 571, 2091, 53, 233, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[23028, 629, 25, 0, 80, "Section"],
Cell[23056, 631, 175, 5, 46, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
